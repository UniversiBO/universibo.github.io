<html>
<head>
<title>File Source for Smarty_Compiler.class.php</title>
<link rel="stylesheet" type="text/css" href="../media/style.css">
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
    <td class="header_top">Smarty</td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td class="header_menu">
  		  [ <a href="../classtrees_Smarty.html" class="menu">class tree: Smarty</a> ]
		  [ <a href="../elementindex_Smarty.html" class="menu">index: Smarty</a> ]
		  [ <a href="../elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="200" class="menu">
	<div id="todolist">
			<p><a href="../todolist.html">Todo List</a></p>
	</div>
      <b>Packages:</b><br />
              <a href="../li_undefined_package.html">undefined_package</a><br />
              <a href="../li_DB.html">DB</a><br />
              <a href="../li_framework.html">framework</a><br />
              <a href="../li_kronos.html">kronos</a><br />
              <a href="../li_PHPMailer.html">PHPMailer</a><br />
              <a href="../li_PHPUnit.html">PHPUnit</a><br />
              <a href="../li_Smarty.html">Smarty</a><br />
              <a href="../li_universibo.html">universibo</a><br />
              <a href="../li_universibo_tests.html">universibo_tests</a><br />
            <br /><br />
                  
      
          </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file Smarty_Compiler.class.php</h1>
<p>Documentation is available at <a href="../Smarty/_universibo2_framework_smarty_Smarty_Compiler_class_php.html">Smarty_Compiler.class.php</a></p>
<pre><a name="a1"></a><br />1     <strong>&lt;?php</strong><a name="a2"></a><br />2     <a name="a3"></a><br />3     <font color="#009999">/**</font><a name="a4"></a><br />4     <font color="#009999"> * Project:     Smarty: the PHP compiling template engine</font><a name="a5"></a><br />5     <font color="#009999"> * File:        Smarty_Compiler.class.php</font><a name="a6"></a><br />6     <font color="#009999"> *</font><a name="a7"></a><br />7     <font color="#009999"> * This library is free software; you can redistribute it and/or</font><a name="a8"></a><br />8     <font color="#009999"> * modify it under the terms of the GNU Lesser General Public</font><a name="a9"></a><br />9     <font color="#009999"> * License as published by the Free Software Foundation; either</font><a name="a10"></a><br />10    <font color="#009999"> * version 2.1 of the License, or (at your option) any later version.</font><a name="a11"></a><br />11    <font color="#009999"> *</font><a name="a12"></a><br />12    <font color="#009999"> * This library is distributed in the hope that it will be useful,</font><a name="a13"></a><br />13    <font color="#009999"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</font><a name="a14"></a><br />14    <font color="#009999"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font><a name="a15"></a><br />15    <font color="#009999"> * Lesser General Public License for more details.</font><a name="a16"></a><br />16    <font color="#009999"> *</font><a name="a17"></a><br />17    <font color="#009999"> * You should have received a copy of the GNU Lesser General Public</font><a name="a18"></a><br />18    <font color="#009999"> * License along with this library; if not, write to the Free Software</font><a name="a19"></a><br />19    <font color="#009999"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font><a name="a20"></a><br />20    <font color="#009999"> *</font><a name="a21"></a><br />21    <font color="#009999"> * You may contact the authors of Smarty by e-mail at:</font><a name="a22"></a><br />22    <font color="#009999"> * monte@ispi.net</font><a name="a23"></a><br />23    <font color="#009999"> * andrei@php.net</font><a name="a24"></a><br />24    <font color="#009999"> *</font><a name="a25"></a><br />25    <font color="#009999"> * Or, write to:</font><a name="a26"></a><br />26    <font color="#009999"> * Monte Ohrt</font><a name="a27"></a><br />27    <font color="#009999"> * Director of Technology, ispi</font><a name="a28"></a><br />28    <font color="#009999"> * 237 S. 70th suite 220</font><a name="a29"></a><br />29    <font color="#009999"> * Lincoln, NE 68510</font><a name="a30"></a><br />30    <font color="#009999"> *</font><a name="a31"></a><br />31    <font color="#009999"> * The latest version of Smarty can be obtained from:</font><a name="a32"></a><br />32    <font color="#009999"> * http://www.phpinsider.com/</font><a name="a33"></a><br />33    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@link</font></strong><font color="#009999"> http://www.phpinsider.com/</font><a name="a34"></a><br />34    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@author</font></strong><font color="#009999"> Monte Ohrt &lt;monte@ispi.net&gt;</font><a name="a35"></a><br />35    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@author</font></strong><font color="#009999"> Andrei Zmievski &lt;andrei@php.net&gt;</font><a name="a36"></a><br />36    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@version</font></strong><font color="#009999"> 2.5.0</font><a name="a37"></a><br />37    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@copyright</font></strong><font color="#009999"> 2001,2002 ispi of Lincoln, Inc.</font><a name="a38"></a><br />38    <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999"> Smarty</font><a name="a39"></a><br />39    <font color="#009999"> */</font><a name="a40"></a><br />40    <a name="a41"></a><br />41    <font color="green">/* $Id: Smarty_Compiler.class.php,v 1.1 2003/07/21 10:41:50 brain_79 Exp $ */</font><a name="a42"></a><br />42    <a name="a43"></a><br />43    <font color="blue">class</font> <a href="../Smarty/Smarty_Compiler.html">Smarty_Compiler</a> <font color="blue">extends</font> <a href="../Smarty/Smarty.html#methodSmarty">Smarty</a> <strong>{</strong><a name="a44"></a><br />44    <a name="a45"></a><br />45        <font color="green">// internal vars</font><a name="a46"></a><br />46        <font color="blue">/**#@+</font color="blue"><a name="a47"></a><br />47    <font color="blue">     *</font color="blue"><font color="blue"> </font color="blue"><strong><font color = "#0099FF">@access</font></strong><font color="blue"> private</font color="blue"><a name="a48"></a><br />48    <font color="blue">     */</font color="blue"><a name="a49"></a><br />49        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_sectionelse_stack">$_sectionelse_stack</a>     =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps track of whether section had 'else' part</font><a name="a50"></a><br />50        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_foreachelse_stack">$_foreachelse_stack</a>     =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps track of whether foreach had 'else' part</font><a name="a51"></a><br />51        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_literal_blocks">$_literal_blocks</a>        =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps literal template blocks</font><a name="a52"></a><br />52        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_php_blocks">$_php_blocks</a>            =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps php code blocks</font><a name="a53"></a><br />53        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_current_file">$_current_file</a>          =   null;       <font color="green">// the current template being compiled</font><a name="a54"></a><br />54        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">$_current_line_no</a>       =   1;          <font color="green">// line number for error messages</font><a name="a55"></a><br />55        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_capture_stack">$_capture_stack</a>         =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps track of nested capture buffers</font><a name="a56"></a><br />56        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">$_plugin_info</a>           =   array<strong>(</strong><strong>)</strong>;    <font color="green">// keeps track of plugins to load</font><a name="a57"></a><br />57        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_init_smarty_vars">$_init_smarty_vars</a>      =   false;<a name="a58"></a><br />58        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_permitted_tokens">$_permitted_tokens</a>        =    array<strong>(</strong><font color="#66cccc">'true'</font><strong>,</strong><font color="#66cccc">'false'</font><strong>,</strong><font color="#66cccc">'yes'</font><strong>,</strong><font color="#66cccc">'no'</font><strong>,</strong><font color="#66cccc">'on'</font><strong>,</strong><font color="#66cccc">'off'</font><strong>,</strong><font color="#66cccc">'null'</font><strong>)</strong>;<a name="a59"></a><br />59        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_db_qstr_regexp">$_db_qstr_regexp</a>        =    null;        <font color="green">// regexps are setup in the constructor</font><a name="a60"></a><br />60        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_si_qstr_regexp">$_si_qstr_regexp</a>        =    null;<a name="a61"></a><br />61        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">$_qstr_regexp</a>            =    null;<a name="a62"></a><br />62        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_func_regexp">$_func_regexp</a>            =    null;<a name="a63"></a><br />63        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_var_bracket_regexp">$_var_bracket_regexp</a>    =    null;<a name="a64"></a><br />64        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_dvar_guts_regexp">$_dvar_guts_regexp</a>        =    null;<a name="a65"></a><br />65        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_dvar_regexp">$_dvar_regexp</a>            =    null;<a name="a66"></a><br />66        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_cvar_regexp">$_cvar_regexp</a>            =    null;<a name="a67"></a><br />67        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_svar_regexp">$_svar_regexp</a>            =    null;<a name="a68"></a><br />68        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_avar_regexp">$_avar_regexp</a>            =    null;<a name="a69"></a><br />69        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">$_mod_regexp</a>            =    null;<a name="a70"></a><br />70        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">$_var_regexp</a>            =    null;<a name="a71"></a><br />71        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_parenth_param_regexp">$_parenth_param_regexp</a>    =    null;<a name="a72"></a><br />72        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_func_call_regexp">$_func_call_regexp</a>        =    null;<a name="a73"></a><br />73        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_obj_ext_regexp">$_obj_ext_regexp</a>        =    null;<a name="a74"></a><br />74        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_obj_start_regexp">$_obj_start_regexp</a>        =    null;<a name="a75"></a><br />75        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_obj_params_regexp">$_obj_params_regexp</a>        =    null;<a name="a76"></a><br />76        <font color="blue">var</font> <a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">$_obj_call_regexp</a>        =    null;<a name="a77"></a><br />77        <strong><font color="blue">/**#@-*/</font></strong><a name="a78"></a><br />78        <font color="#009999">/**</font><a name="a79"></a><br />79    <font color="#009999">	 * The class constructor.</font><a name="a80"></a><br />80    <font color="#009999">	 */</font><a name="a81"></a><br />81        <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#methodSmarty_Compiler">Smarty_Compiler</a><strong>(</strong><strong>)</strong><a name="a82"></a><br />82        <strong>{</strong><a name="a83"></a><br />83            <font color="green">// matches double quoted strings:</font><a name="a84"></a><br />84            <font color="green">// &quot;foobar&quot;</font><a name="a85"></a><br />85            <font color="green">// &quot;foo\&quot;bar&quot;</font><a name="a86"></a><br />86            <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_db_qstr_regexp">_db_qstr_regexp</a> = <font color="#66cccc">'&quot;[^&quot;\\\\]*(?:\\\\.[^&quot;\\\\]*)*&quot;'</font>;<a name="a87"></a><br />87    <a name="a88"></a><br />88            <font color="green">// matches single quoted strings:</font><a name="a89"></a><br />89            <font color="green">// 'foobar'</font><a name="a90"></a><br />90            <font color="green">// 'foo\'bar'</font><a name="a91"></a><br />91            <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_si_qstr_regexp">_si_qstr_regexp</a> = <font color="#66cccc">'\'[^\'\\\\]*(?:\\\\.[^\'\\\\]*)*\''</font>;<a name="a92"></a><br />92    <a name="a93"></a><br />93            <font color="green">// matches single or double quoted strings</font><a name="a94"></a><br />94            <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_db_qstr_regexp">_db_qstr_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_si_qstr_regexp">_si_qstr_regexp</a> . <font color="#66cccc">')'</font>;<a name="a95"></a><br />95    <a name="a96"></a><br />96            <font color="green">// matches bracket portion of vars</font><a name="a97"></a><br />97            <font color="green">// [0]</font><a name="a98"></a><br />98            <font color="green">// [foo]</font><a name="a99"></a><br />99            <font color="green">// [$bar]</font><a name="a100"></a><br />100           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_bracket_regexp">_var_bracket_regexp</a> = <font color="#66cccc">'\[\$?[\w\.]+\]'</font>;<a name="a101"></a><br />101                   <a name="a102"></a><br />102           <font color="green">// matches $ vars (not objects):</font><a name="a103"></a><br />103           <font color="green">// $foo</font><a name="a104"></a><br />104           <font color="green">// $foo.bar</font><a name="a105"></a><br />105           <font color="green">// $foo.bar.foobar</font><a name="a106"></a><br />106           <font color="green">// $foo[0]</font><a name="a107"></a><br />107           <font color="green">// $foo[$bar]</font><a name="a108"></a><br />108           <font color="green">// $foo[5][blah]</font><a name="a109"></a><br />109           <font color="green">// $foo[5].bar[$foobar][4]</font><a name="a110"></a><br />110           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_guts_regexp">_dvar_guts_regexp</a> = <font color="#66cccc">'\w+(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a name="a111"></a><br />111   <a href="../Smarty/Smarty_Compiler.html#var$_var_bracket_regexp">_var_bracket_regexp</a>                . <font color="#66cccc">')*(?:\.\$?\w+(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_bracket_regexp">_var_bracket_regexp</a> . <font color="#66cccc">')*)*'</font>;<a name="a112"></a><br />112           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_regexp">_dvar_regexp</a> = <font color="#66cccc">'\$'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_guts_regexp">_dvar_guts_regexp</a>;<a name="a113"></a><br />113   <a name="a114"></a><br />114           <font color="green">// matches config vars:</font><a name="a115"></a><br />115           <font color="green">// #foo#</font><a name="a116"></a><br />116           <font color="green">// #foobar123_foo#</font><a name="a117"></a><br />117           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_cvar_regexp">_cvar_regexp</a> = <font color="#66cccc">'\#\w+\#'</font>;<a name="a118"></a><br />118   <a name="a119"></a><br />119           <font color="green">// matches section vars:</font><a name="a120"></a><br />120           <font color="green">// %foo.bar%</font><a name="a121"></a><br />121           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_svar_regexp">_svar_regexp</a> = <font color="#66cccc">'\%\w+\.\w+\%'</font>;<a name="a122"></a><br />122   <a name="a123"></a><br />123           <font color="green">// matches all valid variables (no quotes, no modifiers)</font><a name="a124"></a><br />124           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_avar_regexp">_avar_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_regexp">_dvar_regexp</a> . <font color="#66cccc">'|'</font><a name="a125"></a><br />125              . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_cvar_regexp">_cvar_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_svar_regexp">_svar_regexp</a> . <font color="#66cccc">')'</font>;<a name="a126"></a><br />126   <a name="a127"></a><br />127           <font color="green">// matches valid variable syntax:</font><a name="a128"></a><br />128           <font color="green">// $foo</font><a name="a129"></a><br />129           <font color="green">// $foo</font><a name="a130"></a><br />130           <font color="green">// #foo#</font><a name="a131"></a><br />131           <font color="green">// #foo#</font><a name="a132"></a><br />132           <font color="green">// &quot;text&quot;</font><a name="a133"></a><br />133           <font color="green">// &quot;text&quot;</font><a name="a134"></a><br />134           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_avar_regexp">_avar_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> . <font color="#66cccc">')'</font>;<a name="a135"></a><br />135                   <a name="a136"></a><br />136           <font color="green">// matches valid object call (no objects allowed in parameters):</font><a name="a137"></a><br />137           <font color="green">// $foo-&gt;bar</font><a name="a138"></a><br />138           <font color="green">// $foo-&gt;bar()</font><a name="a139"></a><br />139           <font color="green">// $foo-&gt;bar(&quot;text&quot;)</font><a name="a140"></a><br />140           <font color="green">// $foo-&gt;bar($foo, $bar, &quot;text&quot;)</font><a name="a141"></a><br />141           <font color="green">// $foo-&gt;bar($foo, &quot;foo&quot;)</font><a name="a142"></a><br />142           <font color="green">// $foo-&gt;bar-&gt;foo()</font><a name="a143"></a><br />143           <font color="green">// $foo-&gt;bar-&gt;foo-&gt;bar()</font><a name="a144"></a><br />144           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_ext_regexp">_obj_ext_regexp</a> = <font color="#66cccc">'\-&gt;(?:\$?'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_guts_regexp">_dvar_guts_regexp</a> . <font color="#66cccc">')'</font>;<a name="a145"></a><br />145           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_params_regexp">_obj_params_regexp</a> = <font color="#66cccc">'\((?:\w+|'</font><a name="a146"></a><br />146                   . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">'(?:\s*,\s*(?:(?:\w+|'</font><a name="a147"></a><br />147                   . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">')))*)?\)'</font>;        <a name="a148"></a><br />148           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_start_regexp">_obj_start_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_regexp">_dvar_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_ext_regexp">_obj_ext_regexp</a> . <font color="#66cccc">')+)'</font>;<a name="a149"></a><br />149           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_start_regexp">_obj_start_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_params_regexp">_obj_params_regexp</a> . <font color="#66cccc">')?)'</font>;<a name="a150"></a><br />150   <a name="a151"></a><br />151           <font color="green">// matches valid modifier syntax:</font><a name="a152"></a><br />152           <font color="green">// |foo</font><a name="a153"></a><br />153           <font color="green">// |@foo</font><a name="a154"></a><br />154           <font color="green">// |foo:&quot;bar&quot;</font><a name="a155"></a><br />155           <font color="green">// |foo:$bar</font><a name="a156"></a><br />156           <font color="green">// |foo:&quot;bar&quot;:$foobar</font><a name="a157"></a><br />157           <font color="green">// |foo|bar</font><a name="a158"></a><br />158           <font color="green">// |foo:$foo-&gt;bar</font><a name="a159"></a><br />159           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> = <font color="#66cccc">'(?:\|@?\w+(?::(?&gt;\w+|'</font><a name="a160"></a><br />160              . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_avar_regexp">_avar_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> .<font color="#66cccc">'))*)'</font>;        <a name="a161"></a><br />161                   <a name="a162"></a><br />162           <font color="green">// matches valid function name:</font><a name="a163"></a><br />163           <font color="green">// foo123</font><a name="a164"></a><br />164           <font color="green">// _foo_bar</font><a name="a165"></a><br />165           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_func_regexp">_func_regexp</a> = <font color="#66cccc">'[a-zA-Z_]\w*'</font>;<a name="a166"></a><br />166   <a name="a167"></a><br />167           <font color="green">// matches valid registered object:</font><a name="a168"></a><br />168           <font color="green">// foo-&gt;bar</font><a name="a169"></a><br />169           <strong>$this</strong><strong>-&gt;</strong><strong>_reg_obj_regexp</strong> = <font color="#66cccc">'[a-zA-Z_]\w*-&gt;[a-zA-Z_]\w*'</font>;<a name="a170"></a><br />170                   <a name="a171"></a><br />171           <font color="green">// matches valid parameter values:</font><a name="a172"></a><br />172           <font color="green">// true</font><a name="a173"></a><br />173           <font color="green">// $foo</font><a name="a174"></a><br />174           <font color="green">// $foo|bar</font><a name="a175"></a><br />175           <font color="green">// #foo#</font><a name="a176"></a><br />176           <font color="green">// #foo#|bar</font><a name="a177"></a><br />177           <font color="green">// &quot;text&quot;</font><a name="a178"></a><br />178           <font color="green">// &quot;text&quot;|bar</font><a name="a179"></a><br />179           <font color="green">// $foo-&gt;bar</font><a name="a180"></a><br />180           <strong>$this</strong><strong>-&gt;</strong><strong>_param_regexp</strong> = <font color="#66cccc">'(?:\s*(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font><a name="a181"></a><br />181              . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a>  . <font color="#66cccc">'|\w+)(?&gt;'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)\s*)'</font>;        <a name="a182"></a><br />182           <a name="a183"></a><br />183           <font color="green">// matches valid parenthesised function parameters:</font><a name="a184"></a><br />184           <font color="green">// </font><a name="a185"></a><br />185           <font color="green">// &quot;text&quot;</font><a name="a186"></a><br />186           <font color="green">//	$foo, $bar, &quot;text&quot;</font><a name="a187"></a><br />187           <font color="green">// $foo|bar, &quot;foo&quot;|bar, $foo-&gt;bar($foo)|bar</font><a name="a188"></a><br />188           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_parenth_param_regexp">_parenth_param_regexp</a> = <font color="#66cccc">'(?:\((?:\w+|'</font><a name="a189"></a><br />189                   . <strong>$this</strong><strong>-&gt;</strong><strong>_param_regexp</strong> . <font color="#66cccc">'(?:\s*,\s*(?:(?:\w+|'</font><a name="a190"></a><br />190                   . <strong>$this</strong><strong>-&gt;</strong><strong>_param_regexp</strong> . <font color="#66cccc">')))*)?\))'</font>;<a name="a191"></a><br />191       <a name="a192"></a><br />192           <font color="green">// matches valid function call:</font><a name="a193"></a><br />193           <font color="green">// foo()</font><a name="a194"></a><br />194           <font color="green">// foo_bar($foo)</font><a name="a195"></a><br />195           <font color="green">// _foo_bar($foo,&quot;bar&quot;)</font><a name="a196"></a><br />196           <font color="green">// foo123($foo,$foo-&gt;bar(),&quot;foo&quot;)</font><a name="a197"></a><br />197           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_func_call_regexp">_func_call_regexp</a> = <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_func_regexp">_func_regexp</a> . <font color="#66cccc">'\s*(?:'</font><a name="a198"></a><br />198              . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_parenth_param_regexp">_parenth_param_regexp</a> . <font color="#66cccc">'))'</font>;        <a name="a199"></a><br />199       <strong>}</strong>            <a name="a200"></a><br />200               <a name="a201"></a><br />201       <font color="#009999">/**</font><a name="a202"></a><br />202   <font color="#009999">	 * compile a template file</font><a name="a203"></a><br />203   <font color="#009999">	 *</font><a name="a204"></a><br />204   <font color="#009999">     * sets $template_compiled to the compiled source</font><a name="a205"></a><br />205   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tpl_file </strong><a name="a206"></a><br />206   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$template_source </strong><a name="a207"></a><br />207   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$template_compiled </strong><a name="a208"></a><br />208   <font color="#009999">	 */</font><a name="a209"></a><br />209       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_file">_compile_file</a><strong>(</strong><strong>$tpl_file</strong><strong>,</strong> <strong>$template_source</strong><strong>,</strong> <strong>&amp;</strong><strong>$template_compiled</strong><strong>)</strong><a name="a210"></a><br />210       <strong>{</strong><a name="a211"></a><br />211           <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security">security</a><strong>)</strong> <strong>{</strong><a name="a212"></a><br />212               <font color="green">// do not allow php syntax to be executed unless specified</font><a name="a213"></a><br />213               <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$php_handling">php_handling</a> == <a href="../Smarty/_universibo2_framework_smarty_Smarty_class_php.html#defineSMARTY_PHP_ALLOW">SMARTY_PHP_ALLOW</a> &amp;&amp;<a name="a214"></a><br />214                   <strong>!</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security_settings">security_settings</a><strong>[</strong><font color="#66cccc">'PHP_HANDLING'</font><strong>]</strong><strong>)</strong> <strong>{</strong><a name="a215"></a><br />215                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$php_handling">php_handling</a> = <a href="../Smarty/_universibo2_framework_smarty_Smarty_class_php.html#defineSMARTY_PHP_PASSTHRU">SMARTY_PHP_PASSTHRU</a>;<a name="a216"></a><br />216               <strong>}</strong><a name="a217"></a><br />217           <strong>}</strong><a name="a218"></a><br />218   <a name="a219"></a><br />219           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_load_filters">_load_filters</a><strong>(</strong><strong>)</strong>;<a name="a220"></a><br />220   <a name="a221"></a><br />221           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_file">_current_file</a> = <strong>$tpl_file</strong>;<a name="a222"></a><br />222           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> = 1;<a name="a223"></a><br />223           <strong>$ldq</strong> = <a href="http://www.php.net/preg_quote">preg_quote</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$left_delimiter">left_delimiter</a><strong>,</strong> <font color="#66cccc">'!'</font><strong>)</strong>;<a name="a224"></a><br />224           <strong>$rdq</strong> = <a href="http://www.php.net/preg_quote">preg_quote</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$right_delimiter">right_delimiter</a><strong>,</strong> <font color="#66cccc">'!'</font><strong>)</strong>;<a name="a225"></a><br />225   <a name="a226"></a><br />226           <font color="green">// run template source through prefilter functions</font><a name="a227"></a><br />227           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong><strong>)</strong> &gt; 0<strong>)</strong> <strong>{</strong><a name="a228"></a><br />228               <font color="blue">foreach</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong> as <strong>$filter_name</strong> =&gt; <strong>$prefilter</strong><strong>)</strong> <strong>{</strong><a name="a229"></a><br />229                   <font color="blue">if</font> <strong>(</strong><strong>$prefilter</strong> === false<strong>)</strong> continue;<a name="a230"></a><br />230                   <font color="blue">if</font> <strong>(</strong><strong>$prefilter</strong><strong>[</strong>3<strong>]</strong> || <a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$prefilter</strong><strong>[</strong>0<strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a231"></a><br />231                       <strong>$template_source</strong> = <strong>$prefilter</strong><strong>[</strong>0<strong>]</strong><strong>(</strong><strong>$template_source</strong><strong>,</strong> <strong>$this</strong><strong>)</strong>;<a name="a232"></a><br />232                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong><strong>[</strong><strong>$filter_name</strong><strong>]</strong><strong>[</strong>3<strong>]</strong> = true;<a name="a233"></a><br />233                   <strong>}</strong> else <strong>{</strong><a name="a234"></a><br />234                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_trigger_fatal_error">_trigger_fatal_error</a><strong>(</strong>&quot;<font color="#66cccc"><strong>[</strong>plugin<strong>]</strong> prefilter '<strong>$filter_name</strong>' is not implemented</font>&quot;<strong>)</strong>;<a name="a235"></a><br />235                   <strong>}</strong><a name="a236"></a><br />236               <strong>}</strong><a name="a237"></a><br />237           <strong>}</strong><a name="a238"></a><br />238   <a name="a239"></a><br />239           <font color="green">/* Annihilate the comments. */</font><a name="a240"></a><br />240           <strong>$template_source</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong>&quot;<font color="#66cccc">!({<strong>$ldq</strong><strong>}</strong>)\*(.*?)\*({<strong>$rdq</strong><strong>}</strong>)!se</font>&quot;<strong>,</strong><a name="a241"></a><br />241                                           <font color="#66cccc">&quot;'\\1*'.str_repeat(\&quot;\n\&quot;, substr_count('\\2', \&quot;\n\&quot;)) .'*\\3'&quot;</font><strong>,</strong><a name="a242"></a><br />242                                           <strong>$template_source</strong><strong>)</strong>;<a name="a243"></a><br />243   <a name="a244"></a><br />244           <font color="green">/* Pull out the literal blocks. */</font><a name="a245"></a><br />245           <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>literal{<strong>$rdq</strong><strong>}</strong>(.*?){<strong>$ldq</strong><strong>}</strong>/literal{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong> <strong>$template_source</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a246"></a><br />246           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_literal_blocks">_literal_blocks</a> = <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a247"></a><br />247           <strong>$template_source</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>literal{<strong>$rdq</strong><strong>}</strong>(.*?){<strong>$ldq</strong><strong>}</strong>/literal{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong><a name="a248"></a><br />248                                           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#methodquote_replace">quote_replace</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$left_delimiter">left_delimiter</a>.<font color="#66cccc">'literal'</font>.<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$right_delimiter">right_delimiter</a><strong>)</strong><strong>,</strong> <strong>$template_source</strong><strong>)</strong>;<a name="a249"></a><br />249   <a name="a250"></a><br />250           <font color="green">/* Pull out the php code blocks. */</font><a name="a251"></a><br />251           <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>php{<strong>$rdq</strong><strong>}</strong>(.*?){<strong>$ldq</strong><strong>}</strong>/php{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong> <strong>$template_source</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a252"></a><br />252           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_php_blocks">_php_blocks</a> = <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a253"></a><br />253           <strong>$template_source</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>php{<strong>$rdq</strong><strong>}</strong>(.*?){<strong>$ldq</strong><strong>}</strong>/php{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong><a name="a254"></a><br />254                                           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#methodquote_replace">quote_replace</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$left_delimiter">left_delimiter</a>.<font color="#66cccc">'php'</font>.<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$right_delimiter">right_delimiter</a><strong>)</strong><strong>,</strong> <strong>$template_source</strong><strong>)</strong>;<a name="a255"></a><br />255   <a name="a256"></a><br />256           <font color="green">/* Gather all template tags. */</font><a name="a257"></a><br />257           <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>\s*(.*?)\s*{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong> <strong>$template_source</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a258"></a><br />258           <strong>$template_tags</strong> = <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a259"></a><br />259           <font color="green">/* Split content by template tags to obtain non-template content. */</font><a name="a260"></a><br />260           <strong>$text_blocks</strong> = <a href="http://www.php.net/preg_split">preg_split</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>.*?{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong> <strong>$template_source</strong><strong>)</strong>;<a name="a261"></a><br />261           <a name="a262"></a><br />262           <font color="green">/* loop through text blocks */</font><a name="a263"></a><br />263           <font color="blue">for</font> <strong>(</strong><strong>$curr_tb</strong> = 0<strong>,</strong> <strong>$for_max</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$text_blocks</strong><strong>)</strong>; <strong>$curr_tb</strong> &lt; <strong>$for_max</strong>; <strong>$curr_tb</strong>++<strong>)</strong> <strong>{</strong><a name="a264"></a><br />264               <font color="green">/* match anything resembling php tags */</font><a name="a265"></a><br />265               <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'!(&lt;\?(?:\w+|=)?|\?&gt;|language\s*=\s*[\&quot;\']?php[\&quot;\']?)!is'</font><strong>,</strong> <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>,</strong> <strong>$sp_match</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a266"></a><br />266                   <font color="green">/* replace tags with placeholders to prevent recursive replacements */</font><a name="a267"></a><br />267                   <strong>$sp_match</strong><strong>[</strong>1<strong>]</strong> = <a href="http://www.php.net/array_unique">array_unique</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>)</strong>;<a name="a268"></a><br />268                   <a href="http://www.php.net/usort">usort</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>,</strong> <font color="#66cccc">'_smarty_sort_length'</font><strong>)</strong>;<a name="a269"></a><br />269                   <font color="blue">for</font> <strong>(</strong><strong>$curr_sp</strong> = 0<strong>,</strong> <strong>$for_max2</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>)</strong>; <strong>$curr_sp</strong> &lt; <strong>$for_max2</strong>; <strong>$curr_sp</strong>++<strong>)</strong> <strong>{</strong><a name="a270"></a><br />270                       <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong><strong>,</strong><font color="#66cccc">'%%%SMARTYSP'</font>.<strong>$curr_sp</strong>.<font color="#66cccc">'%%%'</font><strong>,</strong><strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>)</strong>;<a name="a271"></a><br />271                   <strong>}</strong><a name="a272"></a><br />272                   <font color="green">/* process each one */</font><a name="a273"></a><br />273                   <font color="blue">for</font> <strong>(</strong><strong>$curr_sp</strong> = 0<strong>,</strong> <strong>$for_max2</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>0<strong>]</strong><strong>)</strong>; <strong>$curr_sp</strong> &lt; <strong>$for_max2</strong>; <strong>$curr_sp</strong>++<strong>)</strong> <strong>{</strong><a name="a274"></a><br />274                       <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$php_handling">php_handling</a> == <a href="../Smarty/_universibo2_framework_smarty_Smarty_class_php.html#defineSMARTY_PHP_PASSTHRU">SMARTY_PHP_PASSTHRU</a><strong>)</strong> <strong>{</strong><a name="a275"></a><br />275                           <font color="green">/* echo php contents */</font><a name="a276"></a><br />276                           <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">'%%%SMARTYSP'</font>.<strong>$curr_sp</strong>.<font color="#66cccc">'%%%'</font><strong>,</strong> <font color="#66cccc">'&lt;?php echo \''</font>.<a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">&quot;'&quot;</font><strong>,</strong> <font color="#66cccc">&quot;\'&quot;</font><strong>,</strong> <strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong><strong>)</strong>.<font color="#66cccc">'\'; ?&gt;'</font>.<font color="#66cccc">&quot;\n&quot;</font><strong>,</strong> <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>)</strong>;<a name="a277"></a><br />277                       <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$php_handling">php_handling</a> == <a href="../Smarty/_universibo2_framework_smarty_Smarty_class_php.html#defineSMARTY_PHP_QUOTE">SMARTY_PHP_QUOTE</a><strong>)</strong> <strong>{</strong><a name="a278"></a><br />278                           <font color="green">/* quote php tags */</font><a name="a279"></a><br />279                           <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">'%%%SMARTYSP'</font>.<strong>$curr_sp</strong>.<font color="#66cccc">'%%%'</font><strong>,</strong> <a href="http://www.php.net/htmlspecialchars">htmlspecialchars</a><strong>(</strong><strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong><strong>)</strong><strong>,</strong> <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>)</strong>;<a name="a280"></a><br />280                       <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$php_handling">php_handling</a> == <a href="../Smarty/_universibo2_framework_smarty_Smarty_class_php.html#defineSMARTY_PHP_REMOVE">SMARTY_PHP_REMOVE</a><strong>)</strong> <strong>{</strong><a name="a281"></a><br />281                           <font color="green">/* remove php tags */</font><a name="a282"></a><br />282                           <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">'%%%SMARTYSP'</font>.<strong>$curr_sp</strong>.<font color="#66cccc">'%%%'</font><strong>,</strong> <font color="#66cccc">''</font><strong>,</strong> <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>)</strong>;<a name="a283"></a><br />283                       <strong>}</strong> else <strong>{</strong><a name="a284"></a><br />284                           <font color="green">/* SMARTY_PHP_ALLOW, but echo non php starting tags */</font><a name="a285"></a><br />285                           <strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">'%(&lt;\?(?!php|=|$))%i'</font><strong>,</strong> <font color="#66cccc">'&lt;?php echo \'\\1\'?&gt;'</font>.<font color="#66cccc">&quot;\n&quot;</font><strong>,</strong> <strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong><strong>)</strong>;<a name="a286"></a><br />286                           <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong> = <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">'%%%SMARTYSP'</font>.<strong>$curr_sp</strong>.<font color="#66cccc">'%%%'</font><strong>,</strong> <strong>$sp_match</strong><strong>[</strong>1<strong>]</strong><strong>[</strong><strong>$curr_sp</strong><strong>]</strong><strong>,</strong> <strong>$text_blocks</strong><strong>[</strong><strong>$curr_tb</strong><strong>]</strong><strong>)</strong>;<a name="a287"></a><br />287                       <strong>}</strong><a name="a288"></a><br />288                   <strong>}</strong><a name="a289"></a><br />289               <strong>}</strong><a name="a290"></a><br />290           <strong>}</strong><a name="a291"></a><br />291   <a name="a292"></a><br />292           <font color="green">/* Compile the template tags into PHP code. */</font><a name="a293"></a><br />293           <strong>$compiled_tags</strong> = array<strong>(</strong><strong>)</strong>;<a name="a294"></a><br />294           <font color="blue">for</font> <strong>(</strong><strong>$i</strong> = 0<strong>,</strong> <strong>$for_max</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$template_tags</strong><strong>)</strong>; <strong>$i</strong> &lt; <strong>$for_max</strong>; <strong>$i</strong>++<strong>)</strong> <strong>{</strong><a name="a295"></a><br />295               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> += <a href="http://www.php.net/substr_count">substr_count</a><strong>(</strong><strong>$text_blocks</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>,</strong> <font color="#66cccc">&quot;\n&quot;</font><strong>)</strong>;<a name="a296"></a><br />296               <strong>$compiled_tags</strong><strong>[</strong><strong>]</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_tag">_compile_tag</a><strong>(</strong><strong>$template_tags</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>)</strong>;<a name="a297"></a><br />297               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> += <a href="http://www.php.net/substr_count">substr_count</a><strong>(</strong><strong>$template_tags</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>,</strong> <font color="#66cccc">&quot;\n&quot;</font><strong>)</strong>;<a name="a298"></a><br />298           <strong>}</strong><a name="a299"></a><br />299   <a name="a300"></a><br />300           <strong>$template_compiled</strong> = <font color="#66cccc">''</font>;<a name="a301"></a><br />301   <a name="a302"></a><br />302           <font color="green">/* Interleave the compiled contents and text blocks to get the final result. */</font><a name="a303"></a><br />303           <font color="blue">for</font> <strong>(</strong><strong>$i</strong> = 0<strong>,</strong> <strong>$for_max</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$compiled_tags</strong><strong>)</strong>; <strong>$i</strong> &lt; <strong>$for_max</strong>; <strong>$i</strong>++<strong>)</strong> <strong>{</strong><a name="a304"></a><br />304               <strong>$template_compiled</strong> .= <strong>$text_blocks</strong><strong>[</strong><strong>$i</strong><strong>]</strong>.<strong>$compiled_tags</strong><strong>[</strong><strong>$i</strong><strong>]</strong>;<a name="a305"></a><br />305           <strong>}</strong><a name="a306"></a><br />306           <strong>$template_compiled</strong> .= <strong>$text_blocks</strong><strong>[</strong><strong>$i</strong><strong>]</strong>;<a name="a307"></a><br />307   <a name="a308"></a><br />308           <font color="green">/* Reformat data between 'strip' and '/strip' tags, removing spaces, tabs and newlines. */</font><a name="a309"></a><br />309           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>strip{<strong>$rdq</strong><strong>}</strong>.*?{<strong>$ldq</strong><strong>}</strong>/strip{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong> <strong>$template_compiled</strong><strong>,</strong> <strong>$match</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a310"></a><br />310               <strong>$strip_tags</strong> = <strong>$match</strong><strong>[</strong>0<strong>]</strong>;<a name="a311"></a><br />311               <strong>$strip_tags_modified</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>/?strip{<strong>$rdq</strong><strong>}</strong>|<strong>[</strong>\t <strong>]</strong>+$|^<strong>[</strong>\t <strong>]</strong>+!m</font>&quot;<strong>,</strong> <font color="#66cccc">''</font><strong>,</strong> <strong>$strip_tags</strong><strong>)</strong>;<a name="a312"></a><br />312               <strong>$strip_tags_modified</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">'![\r\n]+!m'</font><strong>,</strong> <font color="#66cccc">''</font><strong>,</strong> <strong>$strip_tags_modified</strong><strong>)</strong>;<a name="a313"></a><br />313               <font color="blue">for</font> <strong>(</strong><strong>$i</strong> = 0<strong>,</strong> <strong>$for_max</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$strip_tags</strong><strong>)</strong>; <strong>$i</strong> &lt; <strong>$for_max</strong>; <strong>$i</strong>++<strong>)</strong><a name="a314"></a><br />314                   <strong>$template_compiled</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong>&quot;<font color="#66cccc">!{<strong>$ldq</strong><strong>}</strong>strip{<strong>$rdq</strong><strong>}</strong>.*?{<strong>$ldq</strong><strong>}</strong>/strip{<strong>$rdq</strong><strong>}</strong>!s</font>&quot;<strong>,</strong><a name="a315"></a><br />315                                                     <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#methodquote_replace">quote_replace</a><strong>(</strong><strong>$strip_tags_modified</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>)</strong><strong>,</strong><a name="a316"></a><br />316                                                     <strong>$template_compiled</strong><strong>,</strong> 1<strong>)</strong>;<a name="a317"></a><br />317           <strong>}</strong><a name="a318"></a><br />318   <a name="a319"></a><br />319           <font color="green">// remove \n from the end of the file, if any</font><a name="a320"></a><br />320           <font color="blue">if</font> <strong>(</strong><strong>$template_compiled</strong><strong>{</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$template_compiled</strong><strong>)</strong> - 1<strong>}</strong> == <font color="#66cccc">&quot;\n&quot;</font> <strong>)</strong> <strong>{</strong><a name="a321"></a><br />321               <strong>$template_compiled</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$template_compiled</strong><strong>,</strong> 0<strong>,</strong> -1<strong>)</strong>;<a name="a322"></a><br />322           <strong>}</strong><a name="a323"></a><br />323   <a name="a324"></a><br />324           <font color="green">// run compiled template through postfilter functions</font><a name="a325"></a><br />325           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong><strong>)</strong> &gt; 0<strong>)</strong> <strong>{</strong><a name="a326"></a><br />326               <font color="blue">foreach</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong> as <strong>$filter_name</strong> =&gt; <strong>$postfilter</strong><strong>)</strong> <strong>{</strong><a name="a327"></a><br />327                   <font color="blue">if</font> <strong>(</strong><strong>$postfilter</strong> === false<strong>)</strong> continue;<a name="a328"></a><br />328                   <font color="blue">if</font> <strong>(</strong><strong>$postfilter</strong><strong>[</strong>3<strong>]</strong> || <a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$postfilter</strong><strong>[</strong>0<strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a329"></a><br />329                       <strong>$template_compiled</strong> = <strong>$postfilter</strong><strong>[</strong>0<strong>]</strong><strong>(</strong><strong>$template_compiled</strong><strong>,</strong> <strong>$this</strong><strong>)</strong>;<a name="a330"></a><br />330                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong><strong>[</strong><strong>$filter_name</strong><strong>]</strong><strong>[</strong>3<strong>]</strong> = true;<a name="a331"></a><br />331                   <strong>}</strong> else <strong>{</strong><a name="a332"></a><br />332                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_trigger_fatal_error">_trigger_fatal_error</a><strong>(</strong>&quot;<font color="#66cccc">Smarty plugin error: postfilter '<strong>$filter_name</strong>' is not implemented</font>&quot;<strong>)</strong>;<a name="a333"></a><br />333                   <strong>}</strong><a name="a334"></a><br />334               <strong>}</strong><a name="a335"></a><br />335           <strong>}</strong><a name="a336"></a><br />336   <a name="a337"></a><br />337           <font color="green">// put header at the top of the compiled template</font><a name="a338"></a><br />338           <strong>$template_header</strong> = <font color="#66cccc">&quot;&lt;?php /* Smarty version &quot;</font>.<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_version">_version</a>.<font color="#66cccc">&quot;, created on &quot;</font>.<a href="http://www.php.net/strftime">strftime</a><strong>(</strong><font color="#66cccc">&quot;%Y-%m-%d %H:%M:%S&quot;</font><strong>)</strong>.<font color="#66cccc">&quot;\n&quot;</font>;<a name="a339"></a><br />339           <strong>$template_header</strong> .= <font color="#66cccc">&quot;         compiled from &quot;</font>.<strong>$tpl_file</strong>.<font color="#66cccc">&quot; */ ?&gt;\n&quot;</font>;<a name="a340"></a><br />340   <a name="a341"></a><br />341           <font color="green">/* Emit code to load needed plugins. */</font><a name="a342"></a><br />342           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a343"></a><br />343               <strong>$plugins_code</strong> = <font color="#66cccc">'&lt;?php $this-&gt;_load_plugins(array('</font>;<a name="a344"></a><br />344               <font color="blue">foreach</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a> as <strong>$plugin_type</strong> =&gt; <strong>$plugins</strong><strong>)</strong> <strong>{</strong><a name="a345"></a><br />345                   <font color="blue">foreach</font> <strong>(</strong><strong>$plugins</strong> as <strong>$plugin_name</strong> =&gt; <strong>$plugin_info</strong><strong>)</strong> <strong>{</strong><a name="a346"></a><br />346                       <strong>$plugins_code</strong> .= &quot;<font color="#66cccc">\narray('<strong>$plugin_type</strong>', '<strong>$plugin_name</strong>', '<strong>$plugin_info</strong><strong>[</strong>0<strong>]</strong>', <strong>$plugin_info</strong><strong>[</strong>1<strong>]</strong>, </font>&quot;;<a name="a347"></a><br />347                       <strong>$plugins_code</strong> .= <strong>$plugin_info</strong><strong>[</strong>2<strong>]</strong> ? <font color="#66cccc">'true),'</font> : <font color="#66cccc">'false),'</font>;<a name="a348"></a><br />348                   <strong>}</strong><a name="a349"></a><br />349               <strong>}</strong><a name="a350"></a><br />350               <strong>$plugins_code</strong> .= <font color="#66cccc">&quot;)); ?&gt;&quot;</font>;<a name="a351"></a><br />351               <strong>$template_header</strong> .= <strong>$plugins_code</strong>;<a name="a352"></a><br />352               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a> = array<strong>(</strong><strong>)</strong>;<a name="a353"></a><br />353           <strong>}</strong><a name="a354"></a><br />354   <a name="a355"></a><br />355           <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_init_smarty_vars">_init_smarty_vars</a><strong>)</strong> <strong>{</strong><a name="a356"></a><br />356               <strong>$template_header</strong> .= <font color="#66cccc">&quot;&lt;?php \$this-&gt;_assign_smarty_interface(); ?&gt;\n&quot;</font>;<a name="a357"></a><br />357               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_init_smarty_vars">_init_smarty_vars</a> = false;<a name="a358"></a><br />358           <strong>}</strong><a name="a359"></a><br />359   <a name="a360"></a><br />360           <strong>$template_compiled</strong> = <strong>$template_header</strong> . <strong>$template_compiled</strong>;<a name="a361"></a><br />361   <a name="a362"></a><br />362           <font color="blue">return</font> true;<a name="a363"></a><br />363       <strong>}</strong><a name="a364"></a><br />364   <a name="a365"></a><br />365       <font color="#009999">/**</font><a name="a366"></a><br />366   <font color="#009999">	 * Compile a template tag</font><a name="a367"></a><br />367   <font color="#009999">	 *</font><a name="a368"></a><br />368   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$template_tag </strong><a name="a369"></a><br />369   <font color="#009999">	 */</font><a name="a370"></a><br />370       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_tag">_compile_tag</a><strong>(</strong><strong>$template_tag</strong><strong>)</strong><a name="a371"></a><br />371       <strong>{</strong>        <a name="a372"></a><br />372                   <a name="a373"></a><br />373           <font color="green">/* Matched comment. */</font><a name="a374"></a><br />374           <font color="blue">if</font> <strong>(</strong><strong>$template_tag</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'*'</font> &amp;&amp; <strong>$template_tag</strong><strong>{</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$template_tag</strong><strong>)</strong> - 1<strong>}</strong> == <font color="#66cccc">'*'</font><strong>)</strong><a name="a375"></a><br />375               <font color="blue">return</font> <font color="#66cccc">''</font>;<a name="a376"></a><br />376           <a name="a377"></a><br />377           <font color="green">/* Split tag into two three parts: command, command modifiers and the arguments. */</font><a name="a378"></a><br />378           <font color="blue">if</font><strong>(</strong><strong>!</strong> <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'/^(?:('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a name="a379"></a><br />379   <a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a>                . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><strong>_reg_obj_regexp</strong> . <font color="#66cccc">'|\/?'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_func_regexp">_func_regexp</a> . <font color="#66cccc">')('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*))</font><a name="a380"></a><br />380   <font color="#66cccc">                      (?:\s+(.*))?$</font><a name="a381"></a><br />381   <font color="#66cccc">                    /xs'</font><strong>,</strong> <strong>$template_tag</strong><strong>,</strong> <strong>$match</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a382"></a><br />382               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">unrecognized tag: <strong>$template_tag</strong></font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a383"></a><br />383           <strong>}</strong><a name="a384"></a><br />384   <a name="a385"></a><br />385           <strong>$tag_command</strong> = <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a386"></a><br />386           <strong>$tag_modifier</strong> = isset<strong>(</strong><strong>$match</strong><strong>[</strong>2<strong>]</strong><strong>)</strong> ? <strong>$match</strong><strong>[</strong>2<strong>]</strong> : null;<a name="a387"></a><br />387           <strong>$tag_args</strong> = isset<strong>(</strong><strong>$match</strong><strong>[</strong>3<strong>]</strong><strong>)</strong> ? <strong>$match</strong><strong>[</strong>3<strong>]</strong> : null;<a name="a388"></a><br />388           <a name="a389"></a><br />389           <a name="a390"></a><br />390           <font color="green">/* If the tag name is a variable or object, we process it. */</font><a name="a391"></a><br />391           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">'$!'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a392"></a><br />392               <strong>$_return</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$tag_command</strong> . <strong>$tag_modifier</strong><strong>,</strong> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><strong>)</strong>;<a name="a393"></a><br />393               <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong>$_tag_attrs</strong><strong>[</strong><font color="#66cccc">'assign'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a394"></a><br />394                   <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php \$this-&gt;assign('&quot;</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$_tag_attrs</strong><strong>[</strong><font color="#66cccc">'assign'</font><strong>]</strong><strong>)</strong> . &quot;<font color="#66cccc">', <strong>$_return</strong> ); ?&gt;\n</font>&quot;;  <a name="a395"></a><br />395               <strong>}</strong> else <strong>{</strong><a name="a396"></a><br />396                   <font color="blue">return</font> &quot;<font color="#66cccc">&lt;?php echo <strong>$_return</strong>; ?&gt;\n</font>&quot;;<a name="a397"></a><br />397               <strong>}</strong><a name="a398"></a><br />398           <strong>}</strong><a name="a399"></a><br />399           <a name="a400"></a><br />400           <font color="green">/* If the tag name is a registered object, we process it. */</font><a name="a401"></a><br />401           <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><strong>_reg_obj_regexp</strong> . <font color="#66cccc">'$!'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a402"></a><br />402               <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_registered_object_tag">_compile_registered_object_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong>;<a name="a403"></a><br />403           <strong>}</strong><a name="a404"></a><br />404   <a name="a405"></a><br />405           <font color="blue">switch</font> <strong>(</strong><strong>$tag_command</strong><strong>)</strong> <strong>{</strong><a name="a406"></a><br />406               case <font color="#66cccc">'include'</font>:<a name="a407"></a><br />407                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_include_tag">_compile_include_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a408"></a><br />408   <a name="a409"></a><br />409               case <font color="#66cccc">'include_php'</font>:<a name="a410"></a><br />410                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_include_php_tag">_compile_include_php_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a411"></a><br />411   <a name="a412"></a><br />412               case <font color="#66cccc">'if'</font>:<a name="a413"></a><br />413                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_if_tag">_compile_if_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a414"></a><br />414   <a name="a415"></a><br />415               case <font color="#66cccc">'else'</font>:<a name="a416"></a><br />416                   <font color="blue">return</font> <font color="#66cccc">'&lt;?php else: ?&gt;'</font>;<a name="a417"></a><br />417   <a name="a418"></a><br />418               case <font color="#66cccc">'elseif'</font>:<a name="a419"></a><br />419                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_if_tag">_compile_if_tag</a><strong>(</strong><strong>$tag_args</strong><strong>,</strong> true<strong>)</strong>;<a name="a420"></a><br />420   <a name="a421"></a><br />421               case <font color="#66cccc">'/if'</font>:<a name="a422"></a><br />422                   <font color="blue">return</font> <font color="#66cccc">'&lt;?php endif; ?&gt;'</font>;<a name="a423"></a><br />423   <a name="a424"></a><br />424               case <font color="#66cccc">'capture'</font>:<a name="a425"></a><br />425                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_capture_tag">_compile_capture_tag</a><strong>(</strong>true<strong>,</strong> <strong>$tag_args</strong><strong>)</strong>;<a name="a426"></a><br />426   <a name="a427"></a><br />427               case <font color="#66cccc">'/capture'</font>:<a name="a428"></a><br />428                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_capture_tag">_compile_capture_tag</a><strong>(</strong>false<strong>)</strong>;<a name="a429"></a><br />429   <a name="a430"></a><br />430               case <font color="#66cccc">'ldelim'</font>:<a name="a431"></a><br />431                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$left_delimiter">left_delimiter</a>;<a name="a432"></a><br />432   <a name="a433"></a><br />433               case <font color="#66cccc">'rdelim'</font>:<a name="a434"></a><br />434                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$right_delimiter">right_delimiter</a>;<a name="a435"></a><br />435   <a name="a436"></a><br />436               case <font color="#66cccc">'section'</font>:<a name="a437"></a><br />437                   <a href="http://www.php.net/array_push">array_push</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_sectionelse_stack">_sectionelse_stack</a><strong>,</strong> false<strong>)</strong>;<a name="a438"></a><br />438                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_section_start">_compile_section_start</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a439"></a><br />439   <a name="a440"></a><br />440               case <font color="#66cccc">'sectionelse'</font>:<a name="a441"></a><br />441                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_sectionelse_stack">_sectionelse_stack</a><strong>[</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_sectionelse_stack">_sectionelse_stack</a><strong>)</strong>-1<strong>]</strong> = true;<a name="a442"></a><br />442                   <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endfor; else: ?&gt;&quot;</font>;<a name="a443"></a><br />443   <a name="a444"></a><br />444               case <font color="#66cccc">'/section'</font>:<a name="a445"></a><br />445                   <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/array_pop">array_pop</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_sectionelse_stack">_sectionelse_stack</a><strong>)</strong><strong>)</strong><a name="a446"></a><br />446                       <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endif; ?&gt;&quot;</font>;<a name="a447"></a><br />447                   else<a name="a448"></a><br />448                       <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endfor; endif; ?&gt;&quot;</font>;<a name="a449"></a><br />449   <a name="a450"></a><br />450               case <font color="#66cccc">'foreach'</font>:<a name="a451"></a><br />451                   <a href="http://www.php.net/array_push">array_push</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_foreachelse_stack">_foreachelse_stack</a><strong>,</strong> false<strong>)</strong>;<a name="a452"></a><br />452                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_foreach_start">_compile_foreach_start</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a453"></a><br />453                   break;<a name="a454"></a><br />454   <a name="a455"></a><br />455               case <font color="#66cccc">'foreachelse'</font>:<a name="a456"></a><br />456                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_foreachelse_stack">_foreachelse_stack</a><strong>[</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_foreachelse_stack">_foreachelse_stack</a><strong>)</strong>-1<strong>]</strong> = true;<a name="a457"></a><br />457                   <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endforeach; else: ?&gt;&quot;</font>;<a name="a458"></a><br />458   <a name="a459"></a><br />459               case <font color="#66cccc">'/foreach'</font>:<a name="a460"></a><br />460                   <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/array_pop">array_pop</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_foreachelse_stack">_foreachelse_stack</a><strong>)</strong><strong>)</strong><a name="a461"></a><br />461                       <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endif; ?&gt;&quot;</font>;<a name="a462"></a><br />462                   else<a name="a463"></a><br />463                       <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php endforeach; endif; ?&gt;&quot;</font>;<a name="a464"></a><br />464   <a name="a465"></a><br />465               case <font color="#66cccc">'config_load'</font>:<a name="a466"></a><br />466                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_config_load_tag">_compile_config_load_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a467"></a><br />467   <a name="a468"></a><br />468               case <font color="#66cccc">'strip'</font>:<a name="a469"></a><br />469               case <font color="#66cccc">'/strip'</font>:<a name="a470"></a><br />470                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$left_delimiter">left_delimiter</a>.<strong>$tag_command</strong>.<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$right_delimiter">right_delimiter</a>;<a name="a471"></a><br />471   <a name="a472"></a><br />472               case <font color="#66cccc">'literal'</font>:<a name="a473"></a><br />473                   list <strong>(</strong><strong>,</strong><strong>$literal_block</strong><strong>)</strong> = <a href="http://www.php.net/each">each</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_literal_blocks">_literal_blocks</a><strong>)</strong>;<a name="a474"></a><br />474                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> += <a href="http://www.php.net/substr_count">substr_count</a><strong>(</strong><strong>$literal_block</strong><strong>,</strong> <font color="#66cccc">&quot;\n&quot;</font><strong>)</strong>;<a name="a475"></a><br />475                   <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php echo '&quot;</font>.<a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">&quot;'&quot;</font><strong>,</strong> <font color="#66cccc">&quot;\'&quot;</font><strong>,</strong> <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">&quot;\\&quot;</font><strong>,</strong> <font color="#66cccc">&quot;\\\\&quot;</font><strong>,</strong> <strong>$literal_block</strong><strong>)</strong><strong>)</strong>.<font color="#66cccc">&quot;'; ?&gt;\n&quot;</font>;<a name="a476"></a><br />476   <a name="a477"></a><br />477               case <font color="#66cccc">'php'</font>:<a name="a478"></a><br />478                   <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security">security</a> &amp;&amp; <strong>!</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security_settings">security_settings</a><strong>[</strong><font color="#66cccc">'PHP_TAGS'</font><strong>]</strong><strong>)</strong> <strong>{</strong><a name="a479"></a><br />479                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;(secure mode) php tags not permitted&quot;</font><strong>,</strong> E_USER_WARNING<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a480"></a><br />480                       <font color="blue">return</font>;<a name="a481"></a><br />481                   <strong>}</strong><a name="a482"></a><br />482                   list <strong>(</strong><strong>,</strong><strong>$php_block</strong><strong>)</strong> = <a href="http://www.php.net/each">each</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_php_blocks">_php_blocks</a><strong>)</strong>;<a name="a483"></a><br />483                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> += <a href="http://www.php.net/substr_count">substr_count</a><strong>(</strong><strong>$php_block</strong><strong>,</strong> <font color="#66cccc">&quot;\n&quot;</font><strong>)</strong>;<a name="a484"></a><br />484                   <font color="blue">return</font> <font color="#66cccc">'&lt;?php '</font>.<strong>$php_block</strong>.<font color="#66cccc">' ?&gt;'</font>;<a name="a485"></a><br />485   <a name="a486"></a><br />486               case <font color="#66cccc">'insert'</font>:<a name="a487"></a><br />487                   <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_insert_tag">_compile_insert_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a488"></a><br />488   <a name="a489"></a><br />489               default:<a name="a490"></a><br />490                   <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_compiler_tag">_compile_compiler_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$output</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a491"></a><br />491                       <font color="blue">return</font> <strong>$output</strong>;<a name="a492"></a><br />492                   <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_block_tag">_compile_block_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>,</strong> <strong>$output</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a493"></a><br />493                       <font color="blue">return</font> <strong>$output</strong>;<a name="a494"></a><br />494                   <strong>}</strong> else <strong>{</strong><a name="a495"></a><br />495                       <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_custom_tag">_compile_custom_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong>;<a name="a496"></a><br />496                   <strong>}</strong><a name="a497"></a><br />497           <strong>}</strong><a name="a498"></a><br />498       <strong>}</strong><a name="a499"></a><br />499   <a name="a500"></a><br />500   <a name="a501"></a><br />501       <font color="#009999">/**</font><a name="a502"></a><br />502   <font color="#009999">	 * compile the custom compiler tag</font><a name="a503"></a><br />503   <font color="#009999">	 *</font><a name="a504"></a><br />504   <font color="#009999">     * sets $output to the compiled custom compiler tag</font><a name="a505"></a><br />505   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_command </strong><a name="a506"></a><br />506   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a507"></a><br />507   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$output </strong><a name="a508"></a><br />508   <font color="#009999">	 */</font><a name="a509"></a><br />509       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_compiler_tag">_compile_compiler_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>&amp;</strong><strong>$output</strong><strong>)</strong><a name="a510"></a><br />510       <strong>{</strong><a name="a511"></a><br />511           <strong>$found</strong> = false;<a name="a512"></a><br />512           <strong>$have_function</strong> = true;<a name="a513"></a><br />513   <a name="a514"></a><br />514           <font color="green">/*</font><a name="a515"></a><br />515   <font color="green">         * First we check if the compiler function has already been registered</font><a name="a516"></a><br />516   <font color="green">         * or loaded from a plugin file.</font><a name="a517"></a><br />517   <font color="green">         */</font><a name="a518"></a><br />518           <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'compiler'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a519"></a><br />519               <strong>$found</strong> = true;<a name="a520"></a><br />520               <strong>$plugin_func</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'compiler'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong><strong>[</strong>0<strong>]</strong>;<a name="a521"></a><br />521               <font color="blue">if</font> <strong>(</strong><strong>!</strong><a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$plugin_func</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a522"></a><br />522                   <strong>$message</strong> = &quot;<font color="#66cccc">compiler function '<strong>$tag_command</strong>' is not implemented</font>&quot;;<a name="a523"></a><br />523                   <strong>$have_function</strong> = false;<a name="a524"></a><br />524               <strong>}</strong><a name="a525"></a><br />525           <strong>}</strong><a name="a526"></a><br />526           <font color="green">/*</font><a name="a527"></a><br />527   <font color="green">         * Otherwise we need to load plugin file and look for the function</font><a name="a528"></a><br />528   <font color="green">         * inside it.</font><a name="a529"></a><br />529   <font color="green">         */</font><a name="a530"></a><br />530           else <font color="blue">if</font> <strong>(</strong><strong>$plugin_file</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_get_plugin_filepath">_get_plugin_filepath</a><strong>(</strong><font color="#66cccc">'compiler'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a531"></a><br />531               <strong>$found</strong> = true;<a name="a532"></a><br />532   <a name="a533"></a><br />533               <font color="blue">include_once</font> <strong>$plugin_file</strong>;<a name="a534"></a><br />534   <a name="a535"></a><br />535               <strong>$plugin_func</strong> = <font color="#66cccc">'smarty_compiler_'</font> . <strong>$tag_command</strong>;<a name="a536"></a><br />536               <font color="blue">if</font> <strong>(</strong><strong>!</strong><a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$plugin_func</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a537"></a><br />537                   <strong>$message</strong> = &quot;<font color="#66cccc">plugin function <strong>$plugin_func</strong>() not found in <strong>$plugin_file</strong>\n</font>&quot;;<a name="a538"></a><br />538                   <strong>$have_function</strong> = false;<a name="a539"></a><br />539               <strong>}</strong> else <strong>{</strong><a name="a540"></a><br />540                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'compiler'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong> = array<strong>(</strong><strong>$plugin_func</strong><strong>,</strong> null<strong>,</strong> null<strong>)</strong>;<a name="a541"></a><br />541               <strong>}</strong><a name="a542"></a><br />542           <strong>}</strong><a name="a543"></a><br />543   <a name="a544"></a><br />544           <font color="green">/*</font><a name="a545"></a><br />545   <font color="green">         * True return value means that we either found a plugin or a</font><a name="a546"></a><br />546   <font color="green">         * dynamically registered function. False means that we didn't and the</font><a name="a547"></a><br />547   <font color="green">         * compiler should now emit code to load custom function plugin for this</font><a name="a548"></a><br />548   <font color="green">         * tag.</font><a name="a549"></a><br />549   <font color="green">         */</font><a name="a550"></a><br />550           <font color="blue">if</font> <strong>(</strong><strong>$found</strong><strong>)</strong> <strong>{</strong><a name="a551"></a><br />551               <font color="blue">if</font> <strong>(</strong><strong>$have_function</strong><strong>)</strong> <strong>{</strong><a name="a552"></a><br />552                   <strong>$output</strong> = <font color="#66cccc">'&lt;?php '</font> . <strong>$plugin_func</strong><strong>(</strong><strong>$tag_args</strong><strong>,</strong> <strong>$this</strong><strong>)</strong> . <font color="#66cccc">' ?&gt;'</font>;<a name="a553"></a><br />553               <strong>}</strong> else <strong>{</strong><a name="a554"></a><br />554                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><strong>$message</strong><strong>,</strong> E_USER_WARNING<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a555"></a><br />555               <strong>}</strong><a name="a556"></a><br />556               <font color="blue">return</font> true;<a name="a557"></a><br />557           <strong>}</strong> else <strong>{</strong><a name="a558"></a><br />558               <font color="blue">return</font> false;<a name="a559"></a><br />559           <strong>}</strong><a name="a560"></a><br />560       <strong>}</strong><a name="a561"></a><br />561   <a name="a562"></a><br />562   <a name="a563"></a><br />563       <font color="#009999">/**</font><a name="a564"></a><br />564   <font color="#009999">	 * compile block function tag</font><a name="a565"></a><br />565   <font color="#009999">	 *</font><a name="a566"></a><br />566   <font color="#009999">     * sets $output to compiled block function tag</font><a name="a567"></a><br />567   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_command </strong><a name="a568"></a><br />568   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a569"></a><br />569   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_modifier </strong><a name="a570"></a><br />570   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$output </strong><a name="a571"></a><br />571   <font color="#009999">	 */</font><a name="a572"></a><br />572       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_block_tag">_compile_block_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>,</strong> <strong>&amp;</strong><strong>$output</strong><strong>)</strong><a name="a573"></a><br />573       <strong>{</strong><a name="a574"></a><br />574           <font color="blue">if</font> <strong>(</strong><strong>$tag_command</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'/'</font><strong>)</strong> <strong>{</strong><a name="a575"></a><br />575               <strong>$start_tag</strong> = false;<a name="a576"></a><br />576               <strong>$tag_command</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> 1<strong>)</strong>;<a name="a577"></a><br />577           <strong>}</strong> else<a name="a578"></a><br />578               <strong>$start_tag</strong> = true;<a name="a579"></a><br />579   <a name="a580"></a><br />580           <strong>$found</strong> = false;<a name="a581"></a><br />581           <strong>$have_function</strong> = true;<a name="a582"></a><br />582   <a name="a583"></a><br />583           <font color="green">/*</font><a name="a584"></a><br />584   <font color="green">         * First we check if the block function has already been registered</font><a name="a585"></a><br />585   <font color="green">         * or loaded from a plugin file.</font><a name="a586"></a><br />586   <font color="green">         */</font><a name="a587"></a><br />587           <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'block'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a588"></a><br />588               <strong>$found</strong> = true;<a name="a589"></a><br />589               <strong>$plugin_func</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'block'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong><strong>[</strong>0<strong>]</strong>;<a name="a590"></a><br />590               <font color="blue">if</font> <strong>(</strong><strong>!</strong><a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$plugin_func</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a591"></a><br />591                   <strong>$message</strong> = &quot;<font color="#66cccc">block function '<strong>$tag_command</strong>' is not implemented</font>&quot;;<a name="a592"></a><br />592                   <strong>$have_function</strong> = false;<a name="a593"></a><br />593               <strong>}</strong><a name="a594"></a><br />594           <strong>}</strong><a name="a595"></a><br />595           <font color="green">/*</font><a name="a596"></a><br />596   <font color="green">         * Otherwise we need to load plugin file and look for the function</font><a name="a597"></a><br />597   <font color="green">         * inside it.</font><a name="a598"></a><br />598   <font color="green">         */</font><a name="a599"></a><br />599           else <font color="blue">if</font> <strong>(</strong><strong>$plugin_file</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_get_plugin_filepath">_get_plugin_filepath</a><strong>(</strong><font color="#66cccc">'block'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a600"></a><br />600               <strong>$found</strong> = true;<a name="a601"></a><br />601   <a name="a602"></a><br />602               <font color="blue">include_once</font> <strong>$plugin_file</strong>;<a name="a603"></a><br />603   <a name="a604"></a><br />604               <strong>$plugin_func</strong> = <font color="#66cccc">'smarty_block_'</font> . <strong>$tag_command</strong>;<a name="a605"></a><br />605               <font color="blue">if</font> <strong>(</strong><strong>!</strong><a href="http://www.php.net/function_exists">function_exists</a><strong>(</strong><strong>$plugin_func</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a606"></a><br />606                   <strong>$message</strong> = &quot;<font color="#66cccc">plugin function <strong>$plugin_func</strong>() not found in <strong>$plugin_file</strong>\n</font>&quot;;<a name="a607"></a><br />607                   <strong>$have_function</strong> = false;<a name="a608"></a><br />608               <strong>}</strong> else <strong>{</strong><a name="a609"></a><br />609                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'block'</font><strong>]</strong><strong>[</strong><strong>$tag_command</strong><strong>]</strong> = array<strong>(</strong><strong>$plugin_func</strong><strong>,</strong> null<strong>,</strong> null<strong>)</strong>;<a name="a610"></a><br />610               <strong>}</strong><a name="a611"></a><br />611           <strong>}</strong><a name="a612"></a><br />612   <a name="a613"></a><br />613           <font color="blue">if</font> <strong>(</strong><strong>!</strong><strong>$found</strong><strong>)</strong> <strong>{</strong><a name="a614"></a><br />614               <font color="blue">return</font> false;<a name="a615"></a><br />615           <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>!</strong><strong>$have_function</strong><strong>)</strong> <strong>{</strong><a name="a616"></a><br />616               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><strong>$message</strong><strong>,</strong> E_USER_WARNING<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a617"></a><br />617               <font color="blue">return</font> true;<a name="a618"></a><br />618           <strong>}</strong><a name="a619"></a><br />619   <a name="a620"></a><br />620           <font color="green">/*</font><a name="a621"></a><br />621   <font color="green">         * Even though we've located the plugin function, compilation</font><a name="a622"></a><br />622   <font color="green">         * happens only once, so the plugin will still need to be loaded</font><a name="a623"></a><br />623   <font color="green">         * at runtime for future requests.</font><a name="a624"></a><br />624   <font color="green">         */</font><a name="a625"></a><br />625           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_add_plugin">_add_plugin</a><strong>(</strong><font color="#66cccc">'block'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong>;<a name="a626"></a><br />626   <a name="a627"></a><br />627           <font color="blue">if</font> <strong>(</strong><strong>$start_tag</strong><strong>)</strong> <strong>{</strong><a name="a628"></a><br />628               <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a629"></a><br />629               <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a630"></a><br />630               <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a631"></a><br />631                   <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a632"></a><br />632                       <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a633"></a><br />633                   <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a634"></a><br />634               <strong>}</strong><a name="a635"></a><br />635   <a name="a636"></a><br />636               <strong>$output</strong> = &quot;<font color="#66cccc">&lt;?php \$this<strong>-&gt;</strong>_tag_stack<strong>[</strong><strong>]</strong> = array('<strong>$tag_command</strong>', array(</font>&quot;.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.&quot;<font color="#66cccc">)); \$this<strong>-&gt;</strong>_plugins<strong>[</strong>'block'<strong>]</strong><strong>[</strong>'<strong>$tag_command</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong>(array(</font>&quot;.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;), null, \$this); ob_start(); ?&gt;&quot;</font>;<a name="a637"></a><br />637           <strong>}</strong> else <strong>{</strong><a name="a638"></a><br />638               <strong>$output</strong> = <font color="#66cccc">&quot;&lt;?php \$this-&gt;_block_content = ob_get_contents(); ob_end_clean(); &quot;</font>;<a name="a639"></a><br />639               <strong>$out_tag_text</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_plugins<strong>[</strong>'block'<strong>]</strong><strong>[</strong>'<strong>$tag_command</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong>(\$this<strong>-&gt;</strong>_tag_stack<strong>[</strong>count(\$this<strong>-&gt;</strong>_tag_stack)-1<strong>]</strong><strong>[</strong>1<strong>]</strong>, \$this<strong>-&gt;</strong>_block_content, \$this)</font>&quot;;<a name="a640"></a><br />640               <font color="blue">if</font><strong>(</strong><strong>$tag_modifier</strong> != <font color="#66cccc">''</font><strong>)</strong> <strong>{</strong><a name="a641"></a><br />641                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$out_tag_text</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong>;<a name="a642"></a><br />642               <strong>}</strong><a name="a643"></a><br />643               <strong>$output</strong> .= <font color="#66cccc">'echo '</font> . <strong>$out_tag_text</strong> . <font color="#66cccc">';'</font>;<a name="a644"></a><br />644               <strong>$output</strong> .= <font color="#66cccc">&quot; array_pop(\$this-&gt;_tag_stack); ?&gt;&quot;</font>;<a name="a645"></a><br />645           <strong>}</strong><a name="a646"></a><br />646   <a name="a647"></a><br />647           <font color="blue">return</font> true;<a name="a648"></a><br />648       <strong>}</strong><a name="a649"></a><br />649   <a name="a650"></a><br />650   <a name="a651"></a><br />651       <font color="#009999">/**</font><a name="a652"></a><br />652   <font color="#009999">	 * compile custom function tag</font><a name="a653"></a><br />653   <font color="#009999">	 *</font><a name="a654"></a><br />654   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_command </strong><a name="a655"></a><br />655   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a656"></a><br />656   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_modifier </strong><a name="a657"></a><br />657   <font color="#009999">	 */</font><a name="a658"></a><br />658       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_custom_tag">_compile_custom_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong><a name="a659"></a><br />659       <strong>{</strong><a name="a660"></a><br />660           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_add_plugin">_add_plugin</a><strong>(</strong><font color="#66cccc">'function'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong>;<a name="a661"></a><br />661   <a name="a662"></a><br />662           <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a663"></a><br />663           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a664"></a><br />664   <a name="a665"></a><br />665           <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a666"></a><br />666               <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a667"></a><br />667                   <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a668"></a><br />668               <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a669"></a><br />669                   <strong>$arg_value</strong> = <font color="#66cccc">'null'</font>;<a name="a670"></a><br />670               <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a671"></a><br />671           <strong>}</strong><a name="a672"></a><br />672           <a name="a673"></a><br />673           <strong>$return</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_plugins<strong>[</strong>'function'<strong>]</strong><strong>[</strong>'<strong>$tag_command</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong>(array(</font>&quot;.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;), \$this)&quot;</font>;<a name="a674"></a><br />674           <a name="a675"></a><br />675           <font color="blue">if</font><strong>(</strong><strong>$tag_modifier</strong> != <font color="#66cccc">''</font><strong>)</strong> <strong>{</strong><a name="a676"></a><br />676               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$return</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong>;<a name="a677"></a><br />677           <strong>}</strong><a name="a678"></a><br />678           <a name="a679"></a><br />679           <font color="blue">return</font> <font color="#66cccc">'&lt;?php echo '</font> . <strong>$return</strong> . <font color="#66cccc">&quot; ; ?&gt;\n&quot;</font>;<a name="a680"></a><br />680       <strong>}</strong><a name="a681"></a><br />681   <a name="a682"></a><br />682       <font color="#009999">/**</font><a name="a683"></a><br />683   <font color="#009999">	 * compile a registered object tag</font><a name="a684"></a><br />684   <font color="#009999">	 *</font><a name="a685"></a><br />685   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_command </strong><a name="a686"></a><br />686   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>array </em><font color="#009999"></font><strong>$attrs </strong><a name="a687"></a><br />687   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_modifier </strong><a name="a688"></a><br />688   <font color="#009999">	 */</font><a name="a689"></a><br />689       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_registered_object_tag">_compile_registered_object_tag</a><strong>(</strong><strong>$tag_command</strong><strong>,</strong> <strong>$attrs</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong><a name="a690"></a><br />690       <strong>{</strong><a name="a691"></a><br />691           list<strong>(</strong><strong>$object</strong><strong>,</strong> <strong>$obj_comp</strong><strong>)</strong> = <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">'-&gt;'</font><strong>,</strong> <strong>$tag_command</strong><strong>)</strong>;<a name="a692"></a><br />692   <a name="a693"></a><br />693           <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a694"></a><br />694           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$attrs</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a695"></a><br />695               <strong>$_assign_var</strong> = false;<a name="a696"></a><br />696               <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a697"></a><br />697                   <font color="blue">if</font><strong>(</strong><strong>$arg_name</strong> == <font color="#66cccc">'assign'</font><strong>)</strong> <strong>{</strong><a name="a698"></a><br />698                       <strong>$_assign_var</strong> = <strong>$arg_value</strong>;<a name="a699"></a><br />699                       unset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'assign'</font><strong>]</strong><strong>)</strong>;<a name="a700"></a><br />700                       continue;<a name="a701"></a><br />701                   <strong>}</strong><a name="a702"></a><br />702                   <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a703"></a><br />703                       <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a704"></a><br />704                   <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a705"></a><br />705               <strong>}</strong><a name="a706"></a><br />706           <strong>}</strong><a name="a707"></a><br />707                   <a name="a708"></a><br />708           <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_object">is_object</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_reg_objects">_reg_objects</a><strong>[</strong><strong>$object</strong><strong>]</strong><strong>[</strong>0<strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a709"></a><br />709               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_trigger_fatal_error">_trigger_fatal_error</a><strong>(</strong>&quot;<font color="#66cccc">registered '<strong>$object</strong>' is not an object</font>&quot;<strong>)</strong>;<a name="a710"></a><br />710           <strong>}</strong> elseif<strong>(</strong><strong>!</strong>empty<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_reg_objects">_reg_objects</a><strong>[</strong><strong>$object</strong><strong>]</strong><strong>[</strong>1<strong>]</strong><strong>)</strong> &amp;&amp; <strong>!</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$obj_comp</strong><strong>,</strong> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_reg_objects">_reg_objects</a><strong>[</strong><strong>$object</strong><strong>]</strong><strong>[</strong>1<strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a711"></a><br />711               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_trigger_fatal_error">_trigger_fatal_error</a><strong>(</strong>&quot;<font color="#66cccc">'<strong>$obj_comp</strong>' is not a registered component of object '<strong>$object</strong>'</font>&quot;<strong>)</strong>;<a name="a712"></a><br />712           <strong>}</strong> elseif<strong>(</strong><a href="http://www.php.net/method_exists">method_exists</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_reg_objects">_reg_objects</a><strong>[</strong><strong>$object</strong><strong>]</strong><strong>[</strong>0<strong>]</strong><strong>,</strong> <strong>$obj_comp</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a713"></a><br />713               <font color="green">// method</font><a name="a714"></a><br />714               <font color="blue">if</font><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_reg_objects">_reg_objects</a><strong>[</strong><strong>$object</strong><strong>]</strong><strong>[</strong>2<strong>]</strong><strong>)</strong> <strong>{</strong><a name="a715"></a><br />715                   <font color="green">// smarty object argument format</font><a name="a716"></a><br />716                   <strong>$return</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_reg_objects<strong>[</strong>'<strong>$object</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong><strong>-&gt;</strong><strong>$obj_comp</strong>(array(</font>&quot;.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;), \$this)&quot;</font>;<a name="a717"></a><br />717               <strong>}</strong> else <strong>{</strong><a name="a718"></a><br />718                   <font color="green">// traditional argument format</font><a name="a719"></a><br />719                   <strong>$return</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_reg_objects<strong>[</strong>'<strong>$object</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong><strong>-&gt;</strong><strong>$obj_comp</strong>(</font>&quot;.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> <a href="http://www.php.net/array_values">array_values</a><strong>(</strong><strong>$attrs</strong><strong>)</strong><strong>)</strong>.<font color="#66cccc">&quot;)&quot;</font>;<a name="a720"></a><br />720               <strong>}</strong><a name="a721"></a><br />721           <strong>}</strong> else <strong>{</strong><a name="a722"></a><br />722               <font color="green">// property</font><a name="a723"></a><br />723               <strong>$return</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_reg_objects<strong>[</strong>'<strong>$object</strong>'<strong>]</strong><strong>[</strong>0<strong>]</strong><strong>-&gt;</strong><strong>$obj_comp</strong></font>&quot;;<a name="a724"></a><br />724           <strong>}</strong><a name="a725"></a><br />725           <a name="a726"></a><br />726           <font color="blue">if</font><strong>(</strong><strong>$tag_modifier</strong> != <font color="#66cccc">''</font><strong>)</strong> <strong>{</strong><a name="a727"></a><br />727               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$return</strong><strong>,</strong> <strong>$tag_modifier</strong><strong>)</strong>;<a name="a728"></a><br />728           <strong>}</strong><a name="a729"></a><br />729           <a name="a730"></a><br />730           <font color="blue">if</font><strong>(</strong><strong>$_assign_var</strong><strong>)</strong> <strong>{</strong><a name="a731"></a><br />731               <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php \$this-&gt;assign('&quot;</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$_assign_var</strong><strong>)</strong> .&quot;<font color="#66cccc">',  <strong>$return</strong>); ?&gt;\n</font>&quot;;<a name="a732"></a><br />732           <strong>}</strong> else <strong>{</strong><a name="a733"></a><br />733               <font color="blue">return</font> <font color="#66cccc">'&lt;?php echo '</font> . <strong>$return</strong> . <font color="#66cccc">&quot;; ?&gt;\n&quot;</font>;<a name="a734"></a><br />734           <strong>}</strong><a name="a735"></a><br />735       <strong>}</strong><a name="a736"></a><br />736       <a name="a737"></a><br />737       <a name="a738"></a><br />738   <a name="a739"></a><br />739       <font color="#009999">/**</font><a name="a740"></a><br />740   <font color="#009999">	 * Compile {insert ...} tag</font><a name="a741"></a><br />741   <font color="#009999">	 *</font><a name="a742"></a><br />742   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a743"></a><br />743   <font color="#009999">	 */</font><a name="a744"></a><br />744       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_insert_tag">_compile_insert_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a745"></a><br />745       <strong>{</strong><a name="a746"></a><br />746           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a747"></a><br />747           <strong>$name</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong><strong>)</strong>;<a name="a748"></a><br />748   <a name="a749"></a><br />749           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$name</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a750"></a><br />750               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing insert name&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a751"></a><br />751           <strong>}</strong><a name="a752"></a><br />752   <a name="a753"></a><br />753           <font color="blue">if</font> <strong>(</strong><strong>!</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'script'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a754"></a><br />754               <strong>$delayed_loading</strong> = true;<a name="a755"></a><br />755           <strong>}</strong> else <strong>{</strong><a name="a756"></a><br />756               <strong>$delayed_loading</strong> = false;            <a name="a757"></a><br />757           <strong>}</strong><a name="a758"></a><br />758   <a name="a759"></a><br />759           <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a760"></a><br />760               <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a761"></a><br />761                   <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a762"></a><br />762               <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a763"></a><br />763           <strong>}</strong><a name="a764"></a><br />764   <a name="a765"></a><br />765           <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_add_plugin">_add_plugin</a><strong>(</strong><font color="#66cccc">'insert'</font><strong>,</strong> <strong>$name</strong><strong>,</strong> <strong>$delayed_loading</strong><strong>)</strong>;<a name="a766"></a><br />766   <a name="a767"></a><br />767           <font color="blue">return</font> <font color="#66cccc">&quot;&lt;?php echo \$this-&gt;_run_insert_handler(array(&quot;</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">', '</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;)); ?&gt;\n&quot;</font>;<a name="a768"></a><br />768       <strong>}</strong><a name="a769"></a><br />769   <a name="a770"></a><br />770   <a name="a771"></a><br />771       <font color="#009999">/**</font><a name="a772"></a><br />772   <font color="#009999">	 * Compile {config_load ...} tag</font><a name="a773"></a><br />773   <font color="#009999">	 *</font><a name="a774"></a><br />774   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a775"></a><br />775   <font color="#009999">	 */</font><a name="a776"></a><br />776       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_config_load_tag">_compile_config_load_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a777"></a><br />777       <strong>{</strong><a name="a778"></a><br />778           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a779"></a><br />779   <a name="a780"></a><br />780           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'file'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a781"></a><br />781               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing 'file' attribute in config_load tag&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a782"></a><br />782           <strong>}</strong><a name="a783"></a><br />783   <a name="a784"></a><br />784           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'section'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a785"></a><br />785               <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'section'</font><strong>]</strong> = <font color="#66cccc">'null'</font>;<a name="a786"></a><br />786           <strong>}</strong><a name="a787"></a><br />787   <a name="a788"></a><br />788           <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'scope'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a789"></a><br />789               <strong>$scope</strong> = <strong>@</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'scope'</font><strong>]</strong><strong>)</strong>;<a name="a790"></a><br />790               <font color="blue">if</font> <strong>(</strong><strong>$scope</strong> != <font color="#66cccc">'local'</font> &amp;&amp;<a name="a791"></a><br />791                   <strong>$scope</strong> != <font color="#66cccc">'parent'</font> &amp;&amp;<a name="a792"></a><br />792                   <strong>$scope</strong> != <font color="#66cccc">'global'</font><strong>)</strong> <strong>{</strong><a name="a793"></a><br />793                   <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;invalid 'scope' attribute value&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a794"></a><br />794               <strong>}</strong><a name="a795"></a><br />795           <strong>}</strong> else <strong>{</strong><a name="a796"></a><br />796               <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'global'</font><strong>]</strong><strong>)</strong> &amp;&amp; <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'global'</font><strong>]</strong><strong>)</strong><a name="a797"></a><br />797                   <strong>$scope</strong> = <font color="#66cccc">'parent'</font>;<a name="a798"></a><br />798               else<a name="a799"></a><br />799                   <strong>$scope</strong> = <font color="#66cccc">'local'</font>;<a name="a800"></a><br />800           <strong>}</strong><a name="a801"></a><br />801   <a name="a802"></a><br />802           <font color="blue">return</font> <font color="#66cccc">'&lt;?php $this-&gt;config_load('</font> . <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'file'</font><strong>]</strong> . <font color="#66cccc">', '</font> . <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'section'</font><strong>]</strong> . &quot;<font color="#66cccc">, '<strong>$scope</strong>'); ?&gt;</font>&quot;;<a name="a803"></a><br />803       <strong>}</strong><a name="a804"></a><br />804   <a name="a805"></a><br />805   <a name="a806"></a><br />806       <font color="#009999">/**</font><a name="a807"></a><br />807   <font color="#009999">	 * Compile {include ...} tag</font><a name="a808"></a><br />808   <font color="#009999">	 *</font><a name="a809"></a><br />809   <font color="#009999">	 * $param string $tag_args</font><a name="a810"></a><br />810   <font color="#009999">	 */</font><a name="a811"></a><br />811       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_include_tag">_compile_include_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a812"></a><br />812       <strong>{</strong><a name="a813"></a><br />813           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a814"></a><br />814           <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a815"></a><br />815   <a name="a816"></a><br />816           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'file'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a817"></a><br />817               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing 'file' attribute in include tag&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a818"></a><br />818           <strong>}</strong><a name="a819"></a><br />819   <a name="a820"></a><br />820           <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a821"></a><br />821               <font color="blue">if</font> <strong>(</strong><strong>$arg_name</strong> == <font color="#66cccc">'file'</font><strong>)</strong> <strong>{</strong><a name="a822"></a><br />822                   <strong>$include_file</strong> = <strong>$arg_value</strong>;<a name="a823"></a><br />823                   continue;<a name="a824"></a><br />824               <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$arg_name</strong> == <font color="#66cccc">'assign'</font><strong>)</strong> <strong>{</strong><a name="a825"></a><br />825                   <strong>$assign_var</strong> = <strong>$arg_value</strong>;<a name="a826"></a><br />826                   continue;<a name="a827"></a><br />827               <strong>}</strong><a name="a828"></a><br />828               <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a829"></a><br />829                   <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a830"></a><br />830               <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a831"></a><br />831           <strong>}</strong><a name="a832"></a><br />832   <a name="a833"></a><br />833           <strong>$output</strong> = <font color="#66cccc">'&lt;?php '</font>;<a name="a834"></a><br />834   <a name="a835"></a><br />835           <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$assign_var</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a836"></a><br />836               <strong>$output</strong> .= <font color="#66cccc">&quot;ob_start();\n&quot;</font>;<a name="a837"></a><br />837           <strong>}</strong><a name="a838"></a><br />838   <a name="a839"></a><br />839           <strong>$output</strong> .=  <a name="a840"></a><br />840               <font color="#66cccc">&quot;\$_smarty_tpl_vars = \$this-&gt;_tpl_vars;\n&quot;</font> .<a name="a841"></a><br />841               <font color="#66cccc">&quot;\$this-&gt;_smarty_include(&quot;</font>.<strong>$include_file</strong>.<font color="#66cccc">&quot;, array(&quot;</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;));\n&quot;</font> .<a name="a842"></a><br />842               <font color="#66cccc">&quot;\$this-&gt;_tpl_vars = \$_smarty_tpl_vars;\n&quot;</font> .<a name="a843"></a><br />843               <font color="#66cccc">&quot;unset(\$_smarty_tpl_vars);\n&quot;</font>;<a name="a844"></a><br />844   <a name="a845"></a><br />845           <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$assign_var</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a846"></a><br />846               <strong>$output</strong> .= <font color="#66cccc">&quot;\$this-&gt;assign(&quot;</font> . <strong>$assign_var</strong> . <font color="#66cccc">&quot;, ob_get_contents()); ob_end_clean();\n&quot;</font>;<a name="a847"></a><br />847           <strong>}</strong><a name="a848"></a><br />848   <a name="a849"></a><br />849           <strong>$output</strong> .= <font color="#66cccc">' ?&gt;'</font>;<a name="a850"></a><br />850   <a name="a851"></a><br />851           <font color="blue">return</font> <strong>$output</strong>;<a name="a852"></a><br />852   <a name="a853"></a><br />853       <strong>}</strong><a name="a854"></a><br />854   <a name="a855"></a><br />855       <font color="#009999">/**</font><a name="a856"></a><br />856   <font color="#009999">	 * Compile {include ...} tag</font><a name="a857"></a><br />857   <font color="#009999">	 *</font><a name="a858"></a><br />858   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a859"></a><br />859   <font color="#009999">	 */</font><a name="a860"></a><br />860       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_include_php_tag">_compile_include_php_tag</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a861"></a><br />861       <strong>{</strong><a name="a862"></a><br />862           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a863"></a><br />863   <a name="a864"></a><br />864           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'file'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a865"></a><br />865               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing 'file' attribute in include_php tag&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a866"></a><br />866           <strong>}</strong><a name="a867"></a><br />867   <a name="a868"></a><br />868           <strong>$assign_var</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'assign'</font><strong>]</strong><strong>)</strong>;        <a name="a869"></a><br />869           <strong>$once_var</strong> = <strong>(</strong> <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'once'</font><strong>]</strong> == <font color="#66cccc">'false'</font> <strong>)</strong> ? <font color="#66cccc">'false'</font> : <font color="#66cccc">'true'</font>;<a name="a870"></a><br />870           <a name="a871"></a><br />871           <font color="blue">foreach</font><strong>(</strong><strong>$attrs</strong> as <strong>$arg_name</strong> =&gt; <strong>$arg_value</strong><strong>)</strong> <strong>{</strong><a name="a872"></a><br />872               <font color="blue">if</font><strong>(</strong><strong>$arg_name</strong> != <font color="#66cccc">'file'</font> AND <strong>$arg_name</strong> != <font color="#66cccc">'once'</font> AND <strong>$arg_name</strong> != <font color="#66cccc">'assign'</font><strong>)</strong> <strong>{</strong><a name="a873"></a><br />873                   <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$arg_value</strong><strong>)</strong><strong>)</strong><a name="a874"></a><br />874                       <strong>$arg_value</strong> = <strong>$arg_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a875"></a><br />875                   <strong>$arg_list</strong><strong>[</strong><strong>]</strong> = &quot;<font color="#66cccc">'<strong>$arg_name</strong>' =&gt; <strong>$arg_value</strong></font>&quot;;<a name="a876"></a><br />876               <strong>}</strong><a name="a877"></a><br />877           <strong>}</strong><a name="a878"></a><br />878   <a name="a879"></a><br />879           <strong>$output</strong> =<a name="a880"></a><br />880               &quot;<font color="#66cccc">&lt;?php \$this<strong>-&gt;</strong>_smarty_include_php(<strong>$attrs</strong><strong>[</strong>file<strong>]</strong>, '<strong>$assign_var</strong>', <strong>$once_var</strong>, </font>&quot; .<a name="a881"></a><br />881               <font color="#66cccc">&quot;array(&quot;</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>,</strong> (array)<strong>$arg_list</strong><strong>)</strong>.<font color="#66cccc">&quot;)); ?&gt;&quot;</font>;<a name="a882"></a><br />882                   <a name="a883"></a><br />883           <font color="blue">return</font> <strong>$output</strong>;<a name="a884"></a><br />884       <strong>}</strong><a name="a885"></a><br />885       <a name="a886"></a><br />886   <a name="a887"></a><br />887       <font color="#009999">/**</font><a name="a888"></a><br />888   <font color="#009999">	 * Compile {section ...} tag</font><a name="a889"></a><br />889   <font color="#009999">	 *</font><a name="a890"></a><br />890   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a891"></a><br />891   <font color="#009999">	 */</font><a name="a892"></a><br />892       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_section_start">_compile_section_start</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a893"></a><br />893       <strong>{</strong><a name="a894"></a><br />894           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a895"></a><br />895           <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a896"></a><br />896   <a name="a897"></a><br />897           <strong>$output</strong> = <font color="#66cccc">'&lt;?php '</font>;<a name="a898"></a><br />898           <strong>$section_name</strong> = <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong>;<a name="a899"></a><br />899           <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$section_name</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a900"></a><br />900               <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing section name&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a901"></a><br />901           <strong>}</strong><a name="a902"></a><br />902   <a name="a903"></a><br />903           <strong>$output</strong> .= &quot;<font color="#66cccc">if (isset(\$this<strong>-&gt;</strong>_sections<strong>[</strong><strong>$section_name</strong><strong>]</strong>)) unset(\$this<strong>-&gt;</strong>_sections<strong>[</strong><strong>$section_name</strong><strong>]</strong>);\n</font>&quot;;<a name="a904"></a><br />904           <strong>$section_props</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_sections<strong>[</strong><strong>$section_name</strong><strong>]</strong></font>&quot;;<a name="a905"></a><br />905   <a name="a906"></a><br />906           <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$attr_name</strong> =&gt; <strong>$attr_value</strong><strong>)</strong> <strong>{</strong><a name="a907"></a><br />907               <font color="blue">switch</font> <strong>(</strong><strong>$attr_name</strong><strong>)</strong> <strong>{</strong><a name="a908"></a><br />908                   case <font color="#66cccc">'loop'</font>:<a name="a909"></a><br />909                       <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'loop'<strong>]</strong> = is_array(<strong>$attr_value</strong>) ? count(<strong>$attr_value</strong>) : max(0, (int)<strong>$attr_value</strong>);\n</font>&quot;;<a name="a910"></a><br />910                       break;<a name="a911"></a><br />911   <a name="a912"></a><br />912                   case <font color="#66cccc">'show'</font>:<a name="a913"></a><br />913                       <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_bool">is_bool</a><strong>(</strong><strong>$attr_value</strong><strong>)</strong><strong>)</strong><a name="a914"></a><br />914                           <strong>$show_attr_value</strong> = <strong>$attr_value</strong> ? <font color="#66cccc">'true'</font> : <font color="#66cccc">'false'</font>;<a name="a915"></a><br />915                       else<a name="a916"></a><br />916                           <strong>$show_attr_value</strong> = &quot;<font color="#66cccc">(bool)<strong>$attr_value</strong></font>&quot;;<a name="a917"></a><br />917                       <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'show'<strong>]</strong> = <strong>$show_attr_value</strong>;\n</font>&quot;;<a name="a918"></a><br />918                       break;<a name="a919"></a><br />919   <a name="a920"></a><br />920                   case <font color="#66cccc">'name'</font>:<a name="a921"></a><br />921                       <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'<strong>$attr_name</strong>'<strong>]</strong> = <strong>$attr_value</strong>;\n</font>&quot;;<a name="a922"></a><br />922                       break;<a name="a923"></a><br />923   <a name="a924"></a><br />924                   case <font color="#66cccc">'max'</font>:<a name="a925"></a><br />925                   case <font color="#66cccc">'start'</font>:<a name="a926"></a><br />926                       <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'<strong>$attr_name</strong>'<strong>]</strong> = (int)<strong>$attr_value</strong>;\n</font>&quot;;<a name="a927"></a><br />927                       break;<a name="a928"></a><br />928   <a name="a929"></a><br />929                   case <font color="#66cccc">'step'</font>:<a name="a930"></a><br />930                       <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'<strong>$attr_name</strong>'<strong>]</strong> = ((int)<strong>$attr_value</strong>) == 0 ? 1 : (int)<strong>$attr_value</strong>;\n</font>&quot;;<a name="a931"></a><br />931                       break;<a name="a932"></a><br />932   <a name="a933"></a><br />933                   default:<a name="a934"></a><br />934                       <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">unknown section attribute - '<strong>$attr_name</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a935"></a><br />935                       break;<a name="a936"></a><br />936               <strong>}</strong><a name="a937"></a><br />937           <strong>}</strong><a name="a938"></a><br />938   <a name="a939"></a><br />939           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'show'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a940"></a><br />940               <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'show'<strong>]</strong> = true;\n</font>&quot;;<a name="a941"></a><br />941   <a name="a942"></a><br />942           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'loop'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a943"></a><br />943               <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'loop'<strong>]</strong> = 1;\n</font>&quot;;<a name="a944"></a><br />944   <a name="a945"></a><br />945           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'max'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a946"></a><br />946               <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'max'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong>;\n</font>&quot;;<a name="a947"></a><br />947           else<a name="a948"></a><br />948               <strong>$output</strong> .= &quot;<font color="#66cccc">if ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'max'<strong>]</strong> &lt; 0)\n</font>&quot; .<a name="a949"></a><br />949                          &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'max'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong>;\n</font>&quot;;<a name="a950"></a><br />950   <a name="a951"></a><br />951           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'step'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a952"></a><br />952               <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'step'<strong>]</strong> = 1;\n</font>&quot;;<a name="a953"></a><br />953   <a name="a954"></a><br />954           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'start'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a955"></a><br />955               <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'start'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong> &gt; 0 ? 0 : {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong>-1;\n</font>&quot;;<a name="a956"></a><br />956           else <strong>{</strong><a name="a957"></a><br />957               <strong>$output</strong> .= &quot;<font color="#66cccc">if ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong> &lt; 0)\n</font>&quot; .<a name="a958"></a><br />958                          &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong> = max({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong> &gt; 0 ? 0 : -1, {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong> + {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong>);\n</font>&quot; .<a name="a959"></a><br />959                          <font color="#66cccc">&quot;else\n&quot;</font> .<a name="a960"></a><br />960                          &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong> = min({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong>, {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong> &gt; 0 ? {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong> : {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong>-1);\n</font>&quot;;<a name="a961"></a><br />961           <strong>}</strong><a name="a962"></a><br />962   <a name="a963"></a><br />963           <strong>$output</strong> .= &quot;<font color="#66cccc">if ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'show'<strong>]</strong>) <strong>{</strong>\n</font>&quot;;<a name="a964"></a><br />964           <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'start'</font><strong>]</strong><strong>)</strong> &amp;&amp; <strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'step'</font><strong>]</strong><strong>)</strong> &amp;&amp; <strong>!</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'max'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a965"></a><br />965               <strong>$output</strong> .= &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong>;\n</font>&quot;;<a name="a966"></a><br />966           <strong>}</strong> else <strong>{</strong><a name="a967"></a><br />967               <strong>$output</strong> .= &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong> = min(ceil(({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong> &gt; 0 ? {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'loop'<strong>]</strong> - {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong> : {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong>+1)/abs({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong>)), {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'max'<strong>]</strong>);\n</font>&quot;;<a name="a968"></a><br />968           <strong>}</strong><a name="a969"></a><br />969           <strong>$output</strong> .= &quot;<font color="#66cccc">    if ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong> == 0)\n</font>&quot; .<a name="a970"></a><br />970                      &quot;<font color="#66cccc">        {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'show'<strong>]</strong> = false;\n</font>&quot; .<a name="a971"></a><br />971                      <font color="#66cccc">&quot;} else\n&quot;</font> .<a name="a972"></a><br />972                      &quot;<font color="#66cccc">    {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong> = 0;\n</font>&quot;;<a name="a973"></a><br />973   <a name="a974"></a><br />974           <strong>$output</strong> .= &quot;<font color="#66cccc">if ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'show'<strong>]</strong>):\n</font>&quot;;<a name="a975"></a><br />975           <strong>$output</strong> .= &quot;<a name="a976"></a><br />976   <font color="#66cccc">            for ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'index'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'start'<strong>]</strong>, {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> = 1;</font><a name="a977"></a><br />977   <font color="#66cccc">                 {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> &lt;= {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong>;</font><a name="a978"></a><br />978   <font color="#66cccc">                 {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'index'<strong>]</strong> += {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong>, {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong>++):\n</font>&quot;;<a name="a979"></a><br />979           <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'rownum'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong>;\n</font>&quot;;<a name="a980"></a><br />980           <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'index_prev'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'index'<strong>]</strong> - {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong>;\n</font>&quot;;<a name="a981"></a><br />981           <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'index_next'<strong>]</strong> = {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'index'<strong>]</strong> + {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'step'<strong>]</strong>;\n</font>&quot;;<a name="a982"></a><br />982           <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'first'<strong>]</strong>      = ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> == 1);\n</font>&quot;;<a name="a983"></a><br />983           <strong>$output</strong> .= &quot;{<strong>$section_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'last'<strong>]</strong>       = ({<strong>$section_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> == {<strong>$section_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong>);\n</font>&quot;;<a name="a984"></a><br />984   <a name="a985"></a><br />985           <strong>$output</strong> .= <font color="#66cccc">&quot;?&gt;&quot;</font>;<a name="a986"></a><br />986   <a name="a987"></a><br />987           <font color="blue">return</font> <strong>$output</strong>;<a name="a988"></a><br />988       <strong>}</strong><a name="a989"></a><br />989   <a name="a990"></a><br />990       <a name="a991"></a><br />991       <font color="#009999">/**</font><a name="a992"></a><br />992   <font color="#009999">	 * Compile {foreach ...} tag.</font><a name="a993"></a><br />993   <font color="#009999">	 *</font><a name="a994"></a><br />994   <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a995"></a><br />995   <font color="#009999">	 */</font><a name="a996"></a><br />996       <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_foreach_start">_compile_foreach_start</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong><a name="a997"></a><br />997       <strong>{</strong><a name="a998"></a><br />998           <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a999"></a><br />999           <strong>$arg_list</strong> = array<strong>(</strong><strong>)</strong>;<a name="a1000"></a><br />1000  <a name="a1001"></a><br />1001          <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'from'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1002"></a><br />1002              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing 'from' attribute&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1003"></a><br />1003          <strong>}</strong><a name="a1004"></a><br />1004  <a name="a1005"></a><br />1005          <font color="blue">if</font> <strong>(</strong>empty<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'item'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1006"></a><br />1006              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing 'item' attribute&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1007"></a><br />1007          <strong>}</strong><a name="a1008"></a><br />1008  <a name="a1009"></a><br />1009          <strong>$from</strong> = <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'from'</font><strong>]</strong>;<a name="a1010"></a><br />1010          <strong>$item</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'item'</font><strong>]</strong><strong>)</strong>;<a name="a1011"></a><br />1011          <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a1012"></a><br />1012              <strong>$name</strong> = <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong>;<a name="a1013"></a><br />1013  <a name="a1014"></a><br />1014          <strong>$output</strong> = <font color="#66cccc">'&lt;?php '</font>;<a name="a1015"></a><br />1015          <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$name</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1016"></a><br />1016              <strong>$output</strong> .= &quot;<font color="#66cccc">if (isset(\$this<strong>-&gt;</strong>_foreach<strong>[</strong><strong>$name</strong><strong>]</strong>)) unset(\$this<strong>-&gt;</strong>_foreach<strong>[</strong><strong>$name</strong><strong>]</strong>);\n</font>&quot;;<a name="a1017"></a><br />1017              <strong>$foreach_props</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_foreach<strong>[</strong><strong>$name</strong><strong>]</strong></font>&quot;;<a name="a1018"></a><br />1018          <strong>}</strong><a name="a1019"></a><br />1019  <a name="a1020"></a><br />1020          <strong>$key_part</strong> = <font color="#66cccc">''</font>;<a name="a1021"></a><br />1021  <a name="a1022"></a><br />1022          <font color="blue">foreach</font> <strong>(</strong><strong>$attrs</strong> as <strong>$attr_name</strong> =&gt; <strong>$attr_value</strong><strong>)</strong> <strong>{</strong><a name="a1023"></a><br />1023              <font color="blue">switch</font> <strong>(</strong><strong>$attr_name</strong><strong>)</strong> <strong>{</strong><a name="a1024"></a><br />1024                  case <font color="#66cccc">'key'</font>:<a name="a1025"></a><br />1025                      <strong>$key</strong>  = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_dequote">_dequote</a><strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'key'</font><strong>]</strong><strong>)</strong>;<a name="a1026"></a><br />1026                      <strong>$key_part</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_tpl_vars<strong>[</strong>'<strong>$key</strong>'<strong>]</strong> =&gt; </font>&quot;;<a name="a1027"></a><br />1027                      break;<a name="a1028"></a><br />1028  <a name="a1029"></a><br />1029                  case <font color="#66cccc">'name'</font>:<a name="a1030"></a><br />1030                      <strong>$output</strong> .= &quot;{<strong>$foreach_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'<strong>$attr_name</strong>'<strong>]</strong> = <strong>$attr_value</strong>;\n</font>&quot;;<a name="a1031"></a><br />1031                      break;<a name="a1032"></a><br />1032              <strong>}</strong><a name="a1033"></a><br />1033          <strong>}</strong><a name="a1034"></a><br />1034  <a name="a1035"></a><br />1035          <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$name</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1036"></a><br />1036              <strong>$output</strong> .= &quot;{<strong>$foreach_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'total'<strong>]</strong> = count((array)<strong>$from</strong>);\n</font>&quot;;<a name="a1037"></a><br />1037              <strong>$output</strong> .= &quot;{<strong>$foreach_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'show'<strong>]</strong> = {<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong> &gt; 0;\n</font>&quot;;<a name="a1038"></a><br />1038              <strong>$output</strong> .= &quot;<font color="#66cccc">if ({<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'show'<strong>]</strong>):\n</font>&quot;;<a name="a1039"></a><br />1039              <strong>$output</strong> .= &quot;{<strong>$foreach_props</strong><font color="#66cccc"><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> = 0;\n</font>&quot;;<a name="a1040"></a><br />1040              <strong>$output</strong> .= &quot;<font color="#66cccc">    foreach ((array)<strong>$from</strong> as <strong>$key_part</strong>\$this<strong>-&gt;</strong>_tpl_vars<strong>[</strong>'<strong>$item</strong>'<strong>]</strong>):\n</font>&quot;;<a name="a1041"></a><br />1041              <strong>$output</strong> .= &quot;<font color="#66cccc">        {<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong>++;\n</font>&quot;;<a name="a1042"></a><br />1042              <strong>$output</strong> .= &quot;<font color="#66cccc">        {<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'first'<strong>]</strong> = ({<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> == 1);\n</font>&quot;;<a name="a1043"></a><br />1043              <strong>$output</strong> .= &quot;<font color="#66cccc">        {<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'last'<strong>]</strong>  = ({<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'iteration'<strong>]</strong> == {<strong>$foreach_props</strong><strong>}</strong><strong>[</strong>'total'<strong>]</strong>);\n</font>&quot;;<a name="a1044"></a><br />1044          <strong>}</strong> else <strong>{</strong><a name="a1045"></a><br />1045              <strong>$output</strong> .= &quot;<font color="#66cccc">if (count((array)<strong>$from</strong>)):\n</font>&quot;;<a name="a1046"></a><br />1046              <strong>$output</strong> .= &quot;<font color="#66cccc">    foreach ((array)<strong>$from</strong> as <strong>$key_part</strong>\$this<strong>-&gt;</strong>_tpl_vars<strong>[</strong>'<strong>$item</strong>'<strong>]</strong>):\n</font>&quot;;<a name="a1047"></a><br />1047          <strong>}</strong><a name="a1048"></a><br />1048          <strong>$output</strong> .= <font color="#66cccc">'?&gt;'</font>;<a name="a1049"></a><br />1049  <a name="a1050"></a><br />1050          <font color="blue">return</font> <strong>$output</strong>;<a name="a1051"></a><br />1051      <strong>}</strong><a name="a1052"></a><br />1052  <a name="a1053"></a><br />1053  <a name="a1054"></a><br />1054      <font color="#009999">/**</font><a name="a1055"></a><br />1055  <font color="#009999">	 * Compile {capture} .. {/capture} tags</font><a name="a1056"></a><br />1056  <font color="#009999">	 *</font><a name="a1057"></a><br />1057  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>boolean </em><font color="#009999"></font><strong>$start </strong><font color="#009999">true if this is the {capture} tag</font><a name="a1058"></a><br />1058  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a1059"></a><br />1059  <font color="#009999">	 */</font><a name="a1060"></a><br />1060      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_capture_tag">_compile_capture_tag</a><strong>(</strong><strong>$start</strong><strong>,</strong> <strong>$tag_args</strong> = <font color="#66cccc">''</font><strong>)</strong><a name="a1061"></a><br />1061      <strong>{</strong><a name="a1062"></a><br />1062          <strong>$attrs</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>)</strong>;<a name="a1063"></a><br />1063  <a name="a1064"></a><br />1064          <font color="blue">if</font> <strong>(</strong><strong>$start</strong><strong>)</strong> <strong>{</strong><a name="a1065"></a><br />1065              <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong><strong>)</strong><strong>)</strong><a name="a1066"></a><br />1066                  <strong>$buffer</strong> = <strong>$attrs</strong><strong>[</strong><font color="#66cccc">'name'</font><strong>]</strong>;<a name="a1067"></a><br />1067              else<a name="a1068"></a><br />1068                  <strong>$buffer</strong> = <font color="#66cccc">&quot;'default'&quot;</font>;<a name="a1069"></a><br />1069  <a name="a1070"></a><br />1070              <strong>$output</strong> = <font color="#66cccc">&quot;&lt;?php ob_start(); ?&gt;&quot;</font>;<a name="a1071"></a><br />1071              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_capture_stack">_capture_stack</a><strong>[</strong><strong>]</strong> = <strong>$buffer</strong>;<a name="a1072"></a><br />1072          <strong>}</strong> else <strong>{</strong><a name="a1073"></a><br />1073              <strong>$buffer</strong> = <a href="http://www.php.net/array_pop">array_pop</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_capture_stack">_capture_stack</a><strong>)</strong>;<a name="a1074"></a><br />1074              <strong>$output</strong> = &quot;<font color="#66cccc">&lt;?php \$this<strong>-&gt;</strong>_smarty_vars<strong>[</strong>'capture'<strong>]</strong><strong>[</strong><strong>$buffer</strong><strong>]</strong> = ob_get_contents(); ob_end_clean(); ?&gt;</font>&quot;;<a name="a1075"></a><br />1075          <strong>}</strong><a name="a1076"></a><br />1076  <a name="a1077"></a><br />1077          <font color="blue">return</font> <strong>$output</strong>;<a name="a1078"></a><br />1078      <strong>}</strong><a name="a1079"></a><br />1079  <a name="a1080"></a><br />1080      <font color="#009999">/**</font><a name="a1081"></a><br />1081  <font color="#009999">	 * Compile {if ...} tag</font><a name="a1082"></a><br />1082  <font color="#009999">	 *</font><a name="a1083"></a><br />1083  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a1084"></a><br />1084  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>boolean </em><font color="#009999"></font><strong>$elseif </strong><font color="#009999">if true, uses elseif instead of if</font><a name="a1085"></a><br />1085  <font color="#009999">	 */</font><a name="a1086"></a><br />1086      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_if_tag">_compile_if_tag</a><strong>(</strong><strong>$tag_args</strong><strong>,</strong> <strong>$elseif</strong> = false<strong>)</strong><a name="a1087"></a><br />1087      <strong>{</strong><a name="a1088"></a><br />1088  <a name="a1089"></a><br />1089          <font color="green">/* Tokenize args for 'if' tag. */</font><a name="a1090"></a><br />1090          <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'/(?&gt;</font><a name="a1091"></a><br />1091  <font color="#66cccc">				'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)? | # valid object call</font><a name="a1092"></a><br />1092  <font color="#66cccc">				'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)?	| # var or quoted string</font><a name="a1093"></a><br />1093  <font color="#66cccc">				\-?\d+(?:\.\d+)?|\.\d+|!==|===|==|!=|&lt;&gt;|&lt;&lt;|&gt;&gt;|&lt;=|&gt;=|\&amp;\&amp;|\|\||\(|\)|,|\!|\^|=|\&amp;|\~|&lt;|&gt;|\||\%|\+|\-|\/|\*|\@	| # valid non-word token</font><a name="a1094"></a><br />1094  <font color="#66cccc">				\b\w+\b														| # valid word token</font><a name="a1095"></a><br />1095  <font color="#66cccc">				\S+                                                           # anything else</font><a name="a1096"></a><br />1096  <font color="#66cccc">				)/x'</font><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1097"></a><br />1097                  <a name="a1098"></a><br />1098          <strong>$tokens</strong> = <strong>$match</strong><strong>[</strong>0<strong>]</strong>;<a name="a1099"></a><br />1099                  <a name="a1100"></a><br />1100          <font color="green">// make sure we have balanced parenthesis</font><a name="a1101"></a><br />1101          <strong>$token_count</strong> = <a href="http://www.php.net/array_count_values">array_count_values</a><strong>(</strong><strong>$tokens</strong><strong>)</strong>;<a name="a1102"></a><br />1102          <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong>$token_count</strong><strong>[</strong><font color="#66cccc">'('</font><strong>]</strong><strong>)</strong> &amp;&amp; <strong>$token_count</strong><strong>[</strong><font color="#66cccc">'('</font><strong>]</strong> != <strong>$token_count</strong><strong>[</strong><font color="#66cccc">')'</font><strong>]</strong><strong>)</strong> <strong>{</strong><a name="a1103"></a><br />1103              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;unbalanced parenthesis in if statement&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1104"></a><br />1104          <strong>}</strong><a name="a1105"></a><br />1105                                                  <a name="a1106"></a><br />1106          <strong>$is_arg_stack</strong> = array<strong>(</strong><strong>)</strong>;<a name="a1107"></a><br />1107  <a name="a1108"></a><br />1108          <font color="blue">for</font> <strong>(</strong><strong>$i</strong> = 0; <strong>$i</strong> &lt; <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$tokens</strong><strong>)</strong>; <strong>$i</strong>++<strong>)</strong> <strong>{</strong><a name="a1109"></a><br />1109  <a name="a1110"></a><br />1110              <strong>$token</strong> = <strong>&amp;</strong><strong>$tokens</strong><strong>[</strong><strong>$i</strong><strong>]</strong>;<a name="a1111"></a><br />1111              <a name="a1112"></a><br />1112              <font color="blue">switch</font> <strong>(</strong><a href="http://www.php.net/strtolower">strtolower</a><strong>(</strong><strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1113"></a><br />1113                  case <font color="#66cccc">'!'</font>:<a name="a1114"></a><br />1114                  case <font color="#66cccc">'%'</font>:<a name="a1115"></a><br />1115                  case <font color="#66cccc">'!=='</font>:<a name="a1116"></a><br />1116                  case <font color="#66cccc">'=='</font>:<a name="a1117"></a><br />1117                  case <font color="#66cccc">'==='</font>:<a name="a1118"></a><br />1118                  case <font color="#66cccc">'&gt;'</font>:<a name="a1119"></a><br />1119                  case <font color="#66cccc">'&lt;'</font>:<a name="a1120"></a><br />1120                  case <font color="#66cccc">'!='</font>:<a name="a1121"></a><br />1121                  case <font color="#66cccc">'&lt;&gt;'</font>:<a name="a1122"></a><br />1122                  case <font color="#66cccc">'&lt;&lt;'</font>:<a name="a1123"></a><br />1123                  case <font color="#66cccc">'&gt;&gt;'</font>:<a name="a1124"></a><br />1124                  case <font color="#66cccc">'&lt;='</font>:<a name="a1125"></a><br />1125                  case <font color="#66cccc">'&gt;='</font>:<a name="a1126"></a><br />1126                  case <font color="#66cccc">'&amp;&amp;'</font>:<a name="a1127"></a><br />1127                  case <font color="#66cccc">'||'</font>:<a name="a1128"></a><br />1128                  case <font color="#66cccc">'|'</font>:<a name="a1129"></a><br />1129                  case <font color="#66cccc">'^'</font>:<a name="a1130"></a><br />1130                  case <font color="#66cccc">'&amp;'</font>:<a name="a1131"></a><br />1131                  case <font color="#66cccc">'~'</font>:<a name="a1132"></a><br />1132                  case <font color="#66cccc">')'</font>:<a name="a1133"></a><br />1133                  case <font color="#66cccc">','</font>:<a name="a1134"></a><br />1134                  case <font color="#66cccc">'+'</font>:<a name="a1135"></a><br />1135                  case <font color="#66cccc">'-'</font>:<a name="a1136"></a><br />1136                  case <font color="#66cccc">'*'</font>:<a name="a1137"></a><br />1137                  case <font color="#66cccc">'/'</font>:<a name="a1138"></a><br />1138                  case <font color="#66cccc">'@'</font>:<a name="a1139"></a><br />1139                      break;                    <a name="a1140"></a><br />1140  <a name="a1141"></a><br />1141                  case <font color="#66cccc">'eq'</font>:<a name="a1142"></a><br />1142                      <strong>$token</strong> = <font color="#66cccc">'=='</font>;<a name="a1143"></a><br />1143                      break;<a name="a1144"></a><br />1144  <a name="a1145"></a><br />1145                  case <font color="#66cccc">'ne'</font>:<a name="a1146"></a><br />1146                  case <font color="#66cccc">'neq'</font>:<a name="a1147"></a><br />1147                      <strong>$token</strong> = <font color="#66cccc">'!='</font>;<a name="a1148"></a><br />1148                      break;<a name="a1149"></a><br />1149  <a name="a1150"></a><br />1150                  case <font color="#66cccc">'lt'</font>:<a name="a1151"></a><br />1151                      <strong>$token</strong> = <font color="#66cccc">'&lt;'</font>;<a name="a1152"></a><br />1152                      break;<a name="a1153"></a><br />1153  <a name="a1154"></a><br />1154                  case <font color="#66cccc">'le'</font>:<a name="a1155"></a><br />1155                  case <font color="#66cccc">'lte'</font>:<a name="a1156"></a><br />1156                      <strong>$token</strong> = <font color="#66cccc">'&lt;='</font>;<a name="a1157"></a><br />1157                      break;<a name="a1158"></a><br />1158  <a name="a1159"></a><br />1159                  case <font color="#66cccc">'gt'</font>:<a name="a1160"></a><br />1160                      <strong>$token</strong> = <font color="#66cccc">'&gt;'</font>;<a name="a1161"></a><br />1161                      break;<a name="a1162"></a><br />1162  <a name="a1163"></a><br />1163                  case <font color="#66cccc">'ge'</font>:<a name="a1164"></a><br />1164                  case <font color="#66cccc">'gte'</font>:<a name="a1165"></a><br />1165                      <strong>$token</strong> = <font color="#66cccc">'&gt;='</font>;<a name="a1166"></a><br />1166                      break;<a name="a1167"></a><br />1167  <a name="a1168"></a><br />1168                  case <font color="#66cccc">'and'</font>:<a name="a1169"></a><br />1169                      <strong>$token</strong> = <font color="#66cccc">'&amp;&amp;'</font>;<a name="a1170"></a><br />1170                      break;<a name="a1171"></a><br />1171  <a name="a1172"></a><br />1172                  case <font color="#66cccc">'or'</font>:<a name="a1173"></a><br />1173                      <strong>$token</strong> = <font color="#66cccc">'||'</font>;<a name="a1174"></a><br />1174                      break;<a name="a1175"></a><br />1175  <a name="a1176"></a><br />1176                  case <font color="#66cccc">'not'</font>:<a name="a1177"></a><br />1177                      <strong>$token</strong> = <font color="#66cccc">'!'</font>;<a name="a1178"></a><br />1178                      break;<a name="a1179"></a><br />1179  <a name="a1180"></a><br />1180                  case <font color="#66cccc">'mod'</font>:<a name="a1181"></a><br />1181                      <strong>$token</strong> = <font color="#66cccc">'%'</font>;<a name="a1182"></a><br />1182                      break;<a name="a1183"></a><br />1183  <a name="a1184"></a><br />1184                  case <font color="#66cccc">'('</font>:<a name="a1185"></a><br />1185                      <a href="http://www.php.net/array_push">array_push</a><strong>(</strong><strong>$is_arg_stack</strong><strong>,</strong> <strong>$i</strong><strong>)</strong>;<a name="a1186"></a><br />1186                      break;<a name="a1187"></a><br />1187                      <a name="a1188"></a><br />1188                  case <font color="#66cccc">'is'</font>:<a name="a1189"></a><br />1189                      <font color="green">/* If last token was a ')', we operate on the parenthesized</font><a name="a1190"></a><br />1190  <font color="green">                       expression. The start of the expression is on the stack.</font><a name="a1191"></a><br />1191  <font color="green">                       Otherwise, we operate on the last encountered token. */</font><a name="a1192"></a><br />1192                      <font color="blue">if</font> <strong>(</strong><strong>$tokens</strong><strong>[</strong><strong>$i</strong>-1<strong>]</strong> == <font color="#66cccc">')'</font><strong>)</strong><a name="a1193"></a><br />1193                          <strong>$is_arg_start</strong> = <a href="http://www.php.net/array_pop">array_pop</a><strong>(</strong><strong>$is_arg_stack</strong><strong>)</strong>;<a name="a1194"></a><br />1194                      else<a name="a1195"></a><br />1195                          <strong>$is_arg_start</strong> = <strong>$i</strong>-1;<a name="a1196"></a><br />1196                      <font color="green">/* Construct the argument for 'is' expression, so it knows</font><a name="a1197"></a><br />1197  <font color="green">                       what to operate on. */</font><a name="a1198"></a><br />1198                      <strong>$is_arg</strong> = <a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">' '</font><strong>,</strong> <a href="http://www.php.net/array_slice">array_slice</a><strong>(</strong><strong>$tokens</strong><strong>,</strong> <strong>$is_arg_start</strong><strong>,</strong> <strong>$i</strong> - <strong>$is_arg_start</strong><strong>)</strong><strong>)</strong>;<a name="a1199"></a><br />1199                      <a name="a1200"></a><br />1200                      <font color="green">/* Pass all tokens from next one until the end to the</font><a name="a1201"></a><br />1201  <font color="green">                       'is' expression parsing function. The function will</font><a name="a1202"></a><br />1202  <font color="green">                       return modified tokens, where the first one is the result</font><a name="a1203"></a><br />1203  <font color="green">                       of the 'is' expression and the rest are the tokens it</font><a name="a1204"></a><br />1204  <font color="green">                       didn't touch. */</font>                    <a name="a1205"></a><br />1205                      <strong>$new_tokens</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_is_expr">_parse_is_expr</a><strong>(</strong><strong>$is_arg</strong><strong>,</strong> <a href="http://www.php.net/array_slice">array_slice</a><strong>(</strong><strong>$tokens</strong><strong>,</strong> <strong>$i</strong>+1<strong>)</strong><strong>)</strong>;<a name="a1206"></a><br />1206                                          <a name="a1207"></a><br />1207                      <font color="green">/* Replace the old tokens with the new ones. */</font><a name="a1208"></a><br />1208                      <a href="http://www.php.net/array_splice">array_splice</a><strong>(</strong><strong>$tokens</strong><strong>,</strong> <strong>$is_arg_start</strong><strong>,</strong> <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$tokens</strong><strong>)</strong><strong>,</strong> <strong>$new_tokens</strong><strong>)</strong>;<a name="a1209"></a><br />1209  <a name="a1210"></a><br />1210                      <font color="green">/* Adjust argument start so that it won't change from the</font><a name="a1211"></a><br />1211  <font color="green">                       current position for the next iteration. */</font><a name="a1212"></a><br />1212                      <strong>$i</strong> = <strong>$is_arg_start</strong>;<a name="a1213"></a><br />1213                      break;<a name="a1214"></a><br />1214                      <a name="a1215"></a><br />1215                  default:<a name="a1216"></a><br />1216                      <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_func_regexp">_func_regexp</a> . <font color="#66cccc">'$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong> <strong>)</strong> <strong>{</strong><a name="a1217"></a><br />1217                              <font color="green">// function call	</font><a name="a1218"></a><br />1218                              <font color="blue">if</font><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security">security</a> &amp;&amp;<a name="a1219"></a><br />1219                                 <strong>!</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$token</strong><strong>,</strong> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security_settings">security_settings</a><strong>[</strong><font color="#66cccc">'IF_FUNCS'</font><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1220"></a><br />1220                                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">(secure mode) '<strong>$token</strong>' not allowed in if statement</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1221"></a><br />1221                              <strong>}</strong>                            <a name="a1222"></a><br />1222                      <strong>}</strong> elseif<strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1223"></a><br />1223                          <font color="green">// object or variable</font><a name="a1224"></a><br />1224                          <strong>$token</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$token</strong><strong>)</strong>;<a name="a1225"></a><br />1225                      <strong>}</strong> elseif<strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1226"></a><br />1226                          <font color="green">// number, skip it</font><a name="a1227"></a><br />1227                      <strong>}</strong> else <strong>{</strong><a name="a1228"></a><br />1228                          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">unidentified token '<strong>$token</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1229"></a><br />1229                      <strong>}</strong><a name="a1230"></a><br />1230                      break;<a name="a1231"></a><br />1231              <strong>}</strong><a name="a1232"></a><br />1232          <strong>}</strong><a name="a1233"></a><br />1233                  <a name="a1234"></a><br />1234          <font color="blue">if</font> <strong>(</strong><strong>$elseif</strong><strong>)</strong><a name="a1235"></a><br />1235              <font color="blue">return</font> <font color="#66cccc">'&lt;?php elseif ('</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">' '</font><strong>,</strong> <strong>$tokens</strong><strong>)</strong>.<font color="#66cccc">'): ?&gt;'</font>;<a name="a1236"></a><br />1236          else<a name="a1237"></a><br />1237              <font color="blue">return</font> <font color="#66cccc">'&lt;?php if ('</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">' '</font><strong>,</strong> <strong>$tokens</strong><strong>)</strong>.<font color="#66cccc">'): ?&gt;'</font>;<a name="a1238"></a><br />1238      <strong>}</strong><a name="a1239"></a><br />1239  <a name="a1240"></a><br />1240  <a name="a1241"></a><br />1241      <font color="#009999">/**</font><a name="a1242"></a><br />1242  <font color="#009999">	 * Parse is expression</font><a name="a1243"></a><br />1243  <font color="#009999">	 *</font><a name="a1244"></a><br />1244  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$is_arg </strong><a name="a1245"></a><br />1245  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>array </em><font color="#009999"></font><strong>$tokens </strong><a name="a1246"></a><br />1246  <font color="#009999">	 */</font><a name="a1247"></a><br />1247      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_is_expr">_parse_is_expr</a><strong>(</strong><strong>$is_arg</strong><strong>,</strong> <strong>$tokens</strong><strong>)</strong><a name="a1248"></a><br />1248      <strong>{</strong><a name="a1249"></a><br />1249          <strong>$expr_end</strong> = 0;<a name="a1250"></a><br />1250          <strong>$negate_expr</strong> = false;<a name="a1251"></a><br />1251  <a name="a1252"></a><br />1252          <font color="blue">if</font> <strong>(</strong><strong>(</strong><strong>$first_token</strong> = <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$tokens</strong><strong>)</strong><strong>)</strong> == <font color="#66cccc">'not'</font><strong>)</strong> <strong>{</strong><a name="a1253"></a><br />1253              <strong>$negate_expr</strong> = true;<a name="a1254"></a><br />1254              <strong>$expr_type</strong> = <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$tokens</strong><strong>)</strong>;<a name="a1255"></a><br />1255          <strong>}</strong> else<a name="a1256"></a><br />1256              <strong>$expr_type</strong> = <strong>$first_token</strong>;<a name="a1257"></a><br />1257  <a name="a1258"></a><br />1258          <font color="blue">switch</font> <strong>(</strong><strong>$expr_type</strong><strong>)</strong> <strong>{</strong><a name="a1259"></a><br />1259              case <font color="#66cccc">'even'</font>:<a name="a1260"></a><br />1260                  <font color="blue">if</font> <strong>(</strong><strong>@</strong><strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong><strong>]</strong> == <font color="#66cccc">'by'</font><strong>)</strong> <strong>{</strong><a name="a1261"></a><br />1261                      <strong>$expr_end</strong>++;<a name="a1262"></a><br />1262                      <strong>$expr_arg</strong> = <strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong>++<strong>]</strong>;<a name="a1263"></a><br />1263                      <strong>$expr</strong> = &quot;<font color="#66cccc">!((<strong>$is_arg</strong> / <strong>$expr_arg</strong>) % </font>&quot; . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$expr_arg</strong><strong>)</strong> . <font color="#66cccc">&quot;)&quot;</font>;<a name="a1264"></a><br />1264                  <strong>}</strong> else<a name="a1265"></a><br />1265                      <strong>$expr</strong> = &quot;<font color="#66cccc">!(<strong>$is_arg</strong> % 2)</font>&quot;;<a name="a1266"></a><br />1266                  break;<a name="a1267"></a><br />1267  <a name="a1268"></a><br />1268              case <font color="#66cccc">'odd'</font>:<a name="a1269"></a><br />1269                  <font color="blue">if</font> <strong>(</strong><strong>@</strong><strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong><strong>]</strong> == <font color="#66cccc">'by'</font><strong>)</strong> <strong>{</strong><a name="a1270"></a><br />1270                      <strong>$expr_end</strong>++;<a name="a1271"></a><br />1271                      <strong>$expr_arg</strong> = <strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong>++<strong>]</strong>;<a name="a1272"></a><br />1272                      <strong>$expr</strong> = &quot;<font color="#66cccc">((<strong>$is_arg</strong> / <strong>$expr_arg</strong>) % </font>&quot;. <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$expr_arg</strong><strong>)</strong> . <font color="#66cccc">&quot;)&quot;</font>;<a name="a1273"></a><br />1273                  <strong>}</strong> else<a name="a1274"></a><br />1274                      <strong>$expr</strong> = &quot;<font color="#66cccc">(<strong>$is_arg</strong> % 2)</font>&quot;;<a name="a1275"></a><br />1275                  break;<a name="a1276"></a><br />1276  <a name="a1277"></a><br />1277              case <font color="#66cccc">'div'</font>:<a name="a1278"></a><br />1278                  <font color="blue">if</font> <strong>(</strong><strong>@</strong><strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong><strong>]</strong> == <font color="#66cccc">'by'</font><strong>)</strong> <strong>{</strong><a name="a1279"></a><br />1279                      <strong>$expr_end</strong>++;<a name="a1280"></a><br />1280                      <strong>$expr_arg</strong> = <strong>$tokens</strong><strong>[</strong><strong>$expr_end</strong>++<strong>]</strong>;<a name="a1281"></a><br />1281                      <strong>$expr</strong> = &quot;<font color="#66cccc">!(<strong>$is_arg</strong> % </font>&quot; . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$expr_arg</strong><strong>)</strong> . <font color="#66cccc">&quot;)&quot;</font>;<a name="a1282"></a><br />1282                  <strong>}</strong> else <strong>{</strong><a name="a1283"></a><br />1283                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;expecting 'by' after 'div'&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1284"></a><br />1284                  <strong>}</strong><a name="a1285"></a><br />1285                  break;<a name="a1286"></a><br />1286  <a name="a1287"></a><br />1287              default:<a name="a1288"></a><br />1288                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">unknown 'is' expression - '<strong>$expr_type</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1289"></a><br />1289                  break;<a name="a1290"></a><br />1290          <strong>}</strong><a name="a1291"></a><br />1291  <a name="a1292"></a><br />1292          <font color="blue">if</font> <strong>(</strong><strong>$negate_expr</strong><strong>)</strong> <strong>{</strong><a name="a1293"></a><br />1293              <strong>$expr</strong> = &quot;<font color="#66cccc">!(<strong>$expr</strong>)</font>&quot;;<a name="a1294"></a><br />1294          <strong>}</strong><a name="a1295"></a><br />1295          <a name="a1296"></a><br />1296          <a href="http://www.php.net/array_splice">array_splice</a><strong>(</strong><strong>$tokens</strong><strong>,</strong> 0<strong>,</strong> <strong>$expr_end</strong><strong>,</strong> <strong>$expr</strong><strong>)</strong>;        <a name="a1297"></a><br />1297          <a name="a1298"></a><br />1298          <font color="blue">return</font> <strong>$tokens</strong>;<a name="a1299"></a><br />1299      <strong>}</strong><a name="a1300"></a><br />1300  <a name="a1301"></a><br />1301  <a name="a1302"></a><br />1302      <font color="#009999">/**</font><a name="a1303"></a><br />1303  <font color="#009999">	 * Parse attribute string</font><a name="a1304"></a><br />1304  <font color="#009999">	 *</font><a name="a1305"></a><br />1305  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_args </strong><a name="a1306"></a><br />1306  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>true </em><font color="#009999"></font><strong>$quote </strong><font color="#009999">unused?</font><a name="a1307"></a><br />1307  <font color="#009999">	 */</font><a name="a1308"></a><br />1308      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_attrs">_parse_attrs</a><strong>(</strong><strong>$tag_args</strong><strong>,</strong> <strong>$quote</strong> = true<strong>)</strong><a name="a1309"></a><br />1309      <strong>{</strong><a name="a1310"></a><br />1310                  <a name="a1311"></a><br />1311          <font color="green">/* Tokenize tag attributes. */</font><a name="a1312"></a><br />1312          <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'/(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> . <font color="#66cccc">' | (?&gt;[^&quot;\'=\s]+)</font><a name="a1313"></a><br />1313  <font color="#66cccc">                         )+ |</font><a name="a1314"></a><br />1314  <font color="#66cccc">                         [=]</font><a name="a1315"></a><br />1315  <font color="#66cccc">                        /x'</font><strong>,</strong> <strong>$tag_args</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1316"></a><br />1316          <strong>$tokens</strong>       = <strong>$match</strong><strong>[</strong>0<strong>]</strong>;        <a name="a1317"></a><br />1317                          <a name="a1318"></a><br />1318          <strong>$attrs</strong> = array<strong>(</strong><strong>)</strong>;<a name="a1319"></a><br />1319          <font color="green">/* Parse state:</font><a name="a1320"></a><br />1320  <font color="green">            0 - expecting attribute name</font><a name="a1321"></a><br />1321  <font color="green">            1 - expecting '='</font><a name="a1322"></a><br />1322  <font color="green">            2 - expecting attribute value (not '=') */</font><a name="a1323"></a><br />1323          <strong>$state</strong> = 0;<a name="a1324"></a><br />1324                  <a name="a1325"></a><br />1325          <font color="blue">foreach</font> <strong>(</strong><strong>$tokens</strong> as <strong>$token</strong><strong>)</strong> <strong>{</strong><a name="a1326"></a><br />1326              <font color="blue">switch</font> <strong>(</strong><strong>$state</strong><strong>)</strong> <strong>{</strong><a name="a1327"></a><br />1327                  case 0:<a name="a1328"></a><br />1328                      <font color="green">/* If the token is a valid identifier, we set attribute name</font><a name="a1329"></a><br />1329  <font color="green">                       and go to state 1. */</font><a name="a1330"></a><br />1330                      <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^\w+$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1331"></a><br />1331                          <strong>$attr_name</strong> = <strong>$token</strong>;<a name="a1332"></a><br />1332                          <strong>$state</strong> = 1;<a name="a1333"></a><br />1333                      <strong>}</strong> else<a name="a1334"></a><br />1334                          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">invalid attribute name: '<strong>$token</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1335"></a><br />1335                      break;<a name="a1336"></a><br />1336  <a name="a1337"></a><br />1337                  case 1:<a name="a1338"></a><br />1338                      <font color="green">/* If the token is '=', then we go to state 2. */</font><a name="a1339"></a><br />1339                      <font color="blue">if</font> <strong>(</strong><strong>$token</strong> == <font color="#66cccc">'='</font><strong>)</strong> <strong>{</strong><a name="a1340"></a><br />1340                          <strong>$state</strong> = 2;<a name="a1341"></a><br />1341                      <strong>}</strong> else<a name="a1342"></a><br />1342                          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">expecting '=' after attribute name '<strong>$last_token</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1343"></a><br />1343                      break;<a name="a1344"></a><br />1344  <a name="a1345"></a><br />1345                  case 2:<a name="a1346"></a><br />1346                      <font color="green">/* If token is not '=', we set the attribute value and go to</font><a name="a1347"></a><br />1347  <font color="green">                       state 0. */</font><a name="a1348"></a><br />1348                      <font color="blue">if</font> <strong>(</strong><strong>$token</strong> != <font color="#66cccc">'='</font><strong>)</strong> <strong>{</strong><a name="a1349"></a><br />1349                          <font color="green">/* We booleanize the token if it's a non-quoted possible</font><a name="a1350"></a><br />1350  <font color="green">                           boolean value. */</font><a name="a1351"></a><br />1351                          <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^(on|yes|true)$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1352"></a><br />1352                              <strong>$token</strong> = <font color="#66cccc">'true'</font>;<a name="a1353"></a><br />1353                          <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^(off|no|false)$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1354"></a><br />1354                              <strong>$token</strong> = <font color="#66cccc">'false'</font>;<a name="a1355"></a><br />1355                          <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$token</strong> == <font color="#66cccc">'null'</font><strong>)</strong> <strong>{</strong><a name="a1356"></a><br />1356                              <strong>$token</strong> = <font color="#66cccc">'null'</font>;<a name="a1357"></a><br />1357                          <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^-?[0-9]+$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1358"></a><br />1358                              <font color="green">/* treat integer literally */</font><a name="a1359"></a><br />1359                          <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>!</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">')*$!'</font><strong>,</strong> <strong>$token</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1360"></a><br />1360                              <font color="green">/* treat as a string, double-quote it escaping quotes */</font><a name="a1361"></a><br />1361                              <strong>$token</strong> = <font color="#66cccc">'&quot;'</font>.<a href="http://www.php.net/addslashes">addslashes</a><strong>(</strong><strong>$token</strong><strong>)</strong>.<font color="#66cccc">'&quot;'</font>;<a name="a1362"></a><br />1362                          <strong>}</strong><a name="a1363"></a><br />1363  <a name="a1364"></a><br />1364                          <strong>$attrs</strong><strong>[</strong><strong>$attr_name</strong><strong>]</strong> = <strong>$token</strong>;<a name="a1365"></a><br />1365                          <strong>$state</strong> = 0;<a name="a1366"></a><br />1366                      <strong>}</strong> else<a name="a1367"></a><br />1367                          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;'=' cannot be an attribute value&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1368"></a><br />1368                      break;<a name="a1369"></a><br />1369              <strong>}</strong><a name="a1370"></a><br />1370              <strong>$last_token</strong> = <strong>$token</strong>;<a name="a1371"></a><br />1371          <strong>}</strong><a name="a1372"></a><br />1372  <a name="a1373"></a><br />1373          <font color="blue">if</font><strong>(</strong><strong>$state</strong> != 0<strong>)</strong> <strong>{</strong><a name="a1374"></a><br />1374              <font color="blue">if</font><strong>(</strong><strong>$state</strong> == 1<strong>)</strong> <strong>{</strong><a name="a1375"></a><br />1375                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong>&quot;<font color="#66cccc">expecting '=' after attribute name '<strong>$last_token</strong>'</font>&quot;<strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;                <a name="a1376"></a><br />1376              <strong>}</strong> else <strong>{</strong><a name="a1377"></a><br />1377                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">&quot;missing attribute value&quot;</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;                                <a name="a1378"></a><br />1378              <strong>}</strong><a name="a1379"></a><br />1379          <strong>}</strong><a name="a1380"></a><br />1380          <a name="a1381"></a><br />1381          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_vars_props">_parse_vars_props</a><strong>(</strong><strong>$attrs</strong><strong>)</strong>;<a name="a1382"></a><br />1382          <a name="a1383"></a><br />1383          <font color="blue">return</font> <strong>$attrs</strong>;<a name="a1384"></a><br />1384      <strong>}</strong><a name="a1385"></a><br />1385  <a name="a1386"></a><br />1386      <font color="#009999">/**</font><a name="a1387"></a><br />1387  <font color="#009999">	 * compile multiple variables and section properties tokens into</font><a name="a1388"></a><br />1388  <font color="#009999">	 * PHP code</font><a name="a1389"></a><br />1389  <font color="#009999">	 *</font><a name="a1390"></a><br />1390  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>array </em><font color="#009999"></font><strong>$tokens </strong><a name="a1391"></a><br />1391  <font color="#009999">	 */</font><a name="a1392"></a><br />1392      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_vars_props">_parse_vars_props</a><strong>(</strong><strong>&amp;</strong><strong>$tokens</strong><strong>)</strong><a name="a1393"></a><br />1393      <strong>{</strong><a name="a1394"></a><br />1394          <font color="blue">foreach</font><strong>(</strong><strong>$tokens</strong> as <strong>$key</strong> =&gt; <strong>$val</strong><strong>)</strong> <strong>{</strong>            <a name="a1395"></a><br />1395              <strong>$tokens</strong><strong>[</strong><strong>$key</strong><strong>]</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$val</strong><strong>)</strong>;<a name="a1396"></a><br />1396          <strong>}</strong><a name="a1397"></a><br />1397      <strong>}</strong><a name="a1398"></a><br />1398          <a name="a1399"></a><br />1399      <font color="#009999">/**</font><a name="a1400"></a><br />1400  <font color="#009999">	 * compile single variable and section properties token into</font><a name="a1401"></a><br />1401  <font color="#009999">	 * PHP code</font><a name="a1402"></a><br />1402  <font color="#009999">	 *</font><a name="a1403"></a><br />1403  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$val </strong><a name="a1404"></a><br />1404  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$tag_attrs </strong><a name="a1405"></a><br />1405  <font color="#009999">	 */</font><a name="a1406"></a><br />1406      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><strong>$val</strong><strong>,</strong> <strong>$tag_attrs</strong> = null<strong>)</strong><a name="a1407"></a><br />1407      <strong>{</strong>                    <a name="a1408"></a><br />1408  <a name="a1409"></a><br />1409          <strong>$val</strong> = <a href="http://www.php.net/trim">trim</a><strong>(</strong><strong>$val</strong><strong>)</strong>;<a name="a1410"></a><br />1410  <a name="a1411"></a><br />1411          <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_regexp">_dvar_regexp</a> . <font color="#66cccc">')(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1412"></a><br />1412                  <font color="green">// $ variable or object</font><a name="a1413"></a><br />1413                  <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var">_parse_var</a><strong>(</strong><strong>$val</strong><strong>)</strong>;<a name="a1414"></a><br />1414              <strong>}</strong>            <a name="a1415"></a><br />1415          elseif<strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_db_qstr_regexp">_db_qstr_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1416"></a><br />1416                  <font color="green">// double quoted text</font><a name="a1417"></a><br />1417                  <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_db_qstr_regexp">_db_qstr_regexp</a> . <font color="#66cccc">')('</font>. <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1418"></a><br />1418                  <strong>$return</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_expand_quoted_text">_expand_quoted_text</a><strong>(</strong><strong>$match</strong><strong>[</strong>1<strong>]</strong><strong>)</strong>;<a name="a1419"></a><br />1419                  <font color="blue">if</font><strong>(</strong><strong>$match</strong><strong>[</strong>2<strong>]</strong> != <font color="#66cccc">''</font><strong>)</strong> <strong>{</strong><a name="a1420"></a><br />1420                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$return</strong><strong>,</strong> <strong>$match</strong><strong>[</strong>2<strong>]</strong><strong>)</strong>;<a name="a1421"></a><br />1421                  <strong>}</strong><a name="a1422"></a><br />1422                  <font color="blue">return</font> <strong>$return</strong>;<a name="a1423"></a><br />1423              <strong>}</strong>            <a name="a1424"></a><br />1424          elseif<strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_si_qstr_regexp">_si_qstr_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1425"></a><br />1425                  <font color="green">// single quoted text</font><a name="a1426"></a><br />1426                  <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_si_qstr_regexp">_si_qstr_regexp</a> . <font color="#66cccc">')('</font>. <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1427"></a><br />1427                  <font color="blue">if</font><strong>(</strong><strong>$match</strong><strong>[</strong>2<strong>]</strong> != <font color="#66cccc">''</font><strong>)</strong> <strong>{</strong><a name="a1428"></a><br />1428                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$match</strong><strong>[</strong>1<strong>]</strong><strong>,</strong> <strong>$match</strong><strong>[</strong>2<strong>]</strong><strong>)</strong>;<a name="a1429"></a><br />1429                      <font color="blue">return</font> <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a1430"></a><br />1430                  <strong>}</strong>    <a name="a1431"></a><br />1431              <strong>}</strong>            <a name="a1432"></a><br />1432          elseif<strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_cvar_regexp">_cvar_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1433"></a><br />1433                  <font color="green">// config var</font><a name="a1434"></a><br />1434                  <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_conf_var">_parse_conf_var</a><strong>(</strong><strong>$val</strong><strong>)</strong>;<a name="a1435"></a><br />1435              <strong>}</strong>            <a name="a1436"></a><br />1436          elseif<strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!^'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_svar_regexp">_svar_regexp</a> . <font color="#66cccc">'(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1437"></a><br />1437                  <font color="green">// section var</font><a name="a1438"></a><br />1438                  <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_section_prop">_parse_section_prop</a><strong>(</strong><strong>$val</strong><strong>)</strong>;<a name="a1439"></a><br />1439              <strong>}</strong><a name="a1440"></a><br />1440          elseif<strong>(</strong><strong>!</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$val</strong><strong>,</strong> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_permitted_tokens">_permitted_tokens</a><strong>)</strong> &amp;&amp; <strong>!</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$val</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1441"></a><br />1441              <font color="green">// literal string</font><a name="a1442"></a><br />1442              <font color="blue">return</font> <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_expand_quoted_text">_expand_quoted_text</a><strong>(</strong><font color="#66cccc">'&quot;'</font> . <strong>$val</strong> .<font color="#66cccc">'&quot;'</font><strong>)</strong>;<a name="a1443"></a><br />1443          <strong>}</strong><a name="a1444"></a><br />1444          <font color="blue">return</font> <strong>$val</strong>;<a name="a1445"></a><br />1445      <strong>}</strong><a name="a1446"></a><br />1446  <a name="a1447"></a><br />1447      <font color="#009999">/**</font><a name="a1448"></a><br />1448  <font color="#009999">	 * expand quoted text with embedded variables</font><a name="a1449"></a><br />1449  <font color="#009999">	 *</font><a name="a1450"></a><br />1450  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$var_expr </strong><a name="a1451"></a><br />1451  <font color="#009999">	 */</font><a name="a1452"></a><br />1452      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_expand_quoted_text">_expand_quoted_text</a><strong>(</strong><strong>$var_expr</strong><strong>)</strong><a name="a1453"></a><br />1453      <strong>{</strong><a name="a1454"></a><br />1454          <font color="green">// if contains unescaped $, expand it</font><a name="a1455"></a><br />1455          <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'%(?:\`(?&lt;!\\\\)\$'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_dvar_guts_regexp">_dvar_guts_regexp</a> . <font color="#66cccc">'\`)|(?:(?&lt;!\\\\)\$\w+(\[[a-zA-Z0-9]+\])*)%'</font><strong>,</strong> <strong>$var_expr</strong><strong>,</strong> <strong>$_match</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1456"></a><br />1456              <strong>$_match</strong> = <strong>$_match</strong><strong>[</strong>0<strong>]</strong>;<a name="a1457"></a><br />1457              <a href="http://www.php.net/rsort">rsort</a><strong>(</strong><strong>$_match</strong><strong>)</strong>;<a name="a1458"></a><br />1458              <a href="http://www.php.net/reset">reset</a><strong>(</strong><strong>$_match</strong><strong>)</strong>;<a name="a1459"></a><br />1459              <font color="blue">foreach</font><strong>(</strong><strong>$_match</strong> as <strong>$_var</strong><strong>)</strong> <strong>{</strong><a name="a1460"></a><br />1460                  <strong>$var_expr</strong> = <a href="http://www.php.net/str_replace">str_replace</a> <strong>(</strong><strong>$_var</strong><strong>,</strong> <font color="#66cccc">'&quot;.'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var">_parse_var</a><strong>(</strong><a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><font color="#66cccc">'`'</font><strong>,</strong><font color="#66cccc">''</font><strong>,</strong><strong>$_var</strong><strong>)</strong><strong>)</strong> . <font color="#66cccc">'.&quot;'</font><strong>,</strong> <strong>$var_expr</strong><strong>)</strong>;<a name="a1461"></a><br />1461              <strong>}</strong><a name="a1462"></a><br />1462              <strong>$_return</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">'%\.&quot;&quot;|(?&lt;!\\\\)&quot;&quot;\.%'</font><strong>,</strong> <font color="#66cccc">''</font><strong>,</strong> <strong>$var_expr</strong><strong>)</strong>;<a name="a1463"></a><br />1463          <strong>}</strong> else <strong>{</strong><a name="a1464"></a><br />1464              <strong>$_return</strong> = <strong>$var_expr</strong>;<a name="a1465"></a><br />1465          <strong>}</strong><a name="a1466"></a><br />1466          <font color="green">// replace double quoted literal string with single quotes</font><a name="a1467"></a><br />1467          <strong>$_return</strong> = <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">'!^&quot;([\s\w]+)&quot;$!'</font><strong>,</strong><font color="#66cccc">&quot;'\\1'&quot;</font><strong>,</strong><strong>$_return</strong><strong>)</strong>;<a name="a1468"></a><br />1468          <font color="blue">return</font> <strong>$_return</strong>;<a name="a1469"></a><br />1469      <strong>}</strong><a name="a1470"></a><br />1470      <a name="a1471"></a><br />1471      <font color="#009999">/**</font><a name="a1472"></a><br />1472  <font color="#009999">	 * parse variable expression into PHP code</font><a name="a1473"></a><br />1473  <font color="#009999">	 *</font><a name="a1474"></a><br />1474  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$var_expr </strong><a name="a1475"></a><br />1475  <font color="#009999">	 */</font><a name="a1476"></a><br />1476      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_var">_parse_var</a><strong>(</strong><strong>$var_expr</strong><strong>)</strong><a name="a1477"></a><br />1477      <strong>{</strong><a name="a1478"></a><br />1478          <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_call_regexp">_obj_call_regexp</a> . <font color="#66cccc">'|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_regexp">_var_regexp</a> . <font color="#66cccc">')('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_mod_regexp">_mod_regexp</a> . <font color="#66cccc">'*)$!'</font><strong>,</strong> <strong>$var_expr</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1479"></a><br />1479                          <a name="a1480"></a><br />1480          <strong>$var_ref</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$match</strong><strong>[</strong>1<strong>]</strong><strong>,</strong>1<strong>)</strong>;<a name="a1481"></a><br />1481          <strong>$modifiers</strong> = <strong>$match</strong><strong>[</strong>2<strong>]</strong>;<a name="a1482"></a><br />1482                          <a name="a1483"></a><br />1483          <font color="blue">if</font><strong>(</strong><strong>!</strong>empty<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$default_modifiers">default_modifiers</a><strong>)</strong> &amp;&amp; <strong>!</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!(^|\|)smarty:nodefaults($|\|)!'</font><strong>,</strong><strong>$modifiers</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1484"></a><br />1484              <strong>$_default_mod_string</strong> = <a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">'|'</font><strong>,</strong>(array)<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$default_modifiers">default_modifiers</a><strong>)</strong>;<a name="a1485"></a><br />1485              <strong>$modifiers</strong> = empty<strong>(</strong><strong>$modifiers</strong><strong>)</strong> ? <strong>$_default_mod_string</strong> : <strong>$_default_mod_string</strong> . <font color="#66cccc">'|'</font> . <strong>$modifiers</strong>;<a name="a1486"></a><br />1486          <strong>}</strong><a name="a1487"></a><br />1487  <a name="a1488"></a><br />1488          <font color="green">// get [foo] and .foo and -&gt;foo and (...) pieces			</font><a name="a1489"></a><br />1489          <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'!(?:^\w+)|'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_obj_params_regexp">_obj_params_regexp</a> . <font color="#66cccc">'|(?:'</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_var_bracket_regexp">_var_bracket_regexp</a> . <font color="#66cccc">')|-&gt;\w+|\.\$?\w+|\S+!'</font><strong>,</strong> <strong>$var_ref</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;        <a name="a1490"></a><br />1490                  <a name="a1491"></a><br />1491          <strong>$indexes</strong> = <strong>$match</strong><strong>[</strong>0<strong>]</strong>;<a name="a1492"></a><br />1492          <strong>$var_name</strong> = <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$indexes</strong><strong>)</strong>;<a name="a1493"></a><br />1493          <a name="a1494"></a><br />1494          <font color="green">/* Handle $smarty.* variable references as a special case. */</font><a name="a1495"></a><br />1495          <font color="blue">if</font> <strong>(</strong><strong>$var_name</strong> == <font color="#66cccc">'smarty'</font><strong>)</strong> <strong>{</strong><a name="a1496"></a><br />1496              <font color="green">/*</font><a name="a1497"></a><br />1497  <font color="green">             * If the reference could be compiled, use the compiled output;</font><a name="a1498"></a><br />1498  <font color="green">             * otherwise, fall back on the $smarty variable generated at</font><a name="a1499"></a><br />1499  <font color="green">             * run-time.</font><a name="a1500"></a><br />1500  <font color="green">             */</font><a name="a1501"></a><br />1501              <font color="blue">if</font> <strong>(</strong><strong>(</strong><strong>$smarty_ref</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_compile_smarty_ref">_compile_smarty_ref</a><strong>(</strong><strong>$indexes</strong><strong>)</strong><strong>)</strong> !== null<strong>)</strong> <strong>{</strong><a name="a1502"></a><br />1502                  <strong>$output</strong> = <strong>$smarty_ref</strong>;<a name="a1503"></a><br />1503              <strong>}</strong> else <strong>{</strong><a name="a1504"></a><br />1504                  <strong>$var_name</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$indexes</strong><strong>)</strong><strong>,</strong> 1<strong>)</strong>;<a name="a1505"></a><br />1505                  <strong>$output</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_smarty_vars<strong>[</strong>'<strong>$var_name</strong>'<strong>]</strong></font>&quot;;<a name="a1506"></a><br />1506              <strong>}</strong><a name="a1507"></a><br />1507          <strong>}</strong> else <strong>{</strong><a name="a1508"></a><br />1508              <strong>$output</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_tpl_vars<strong>[</strong>'<strong>$var_name</strong>'<strong>]</strong></font>&quot;;<a name="a1509"></a><br />1509          <strong>}</strong><a name="a1510"></a><br />1510          <a name="a1511"></a><br />1511          <font color="blue">foreach</font> <strong>(</strong><strong>$indexes</strong> as <strong>$index</strong><strong>)</strong> <strong>{</strong>            <a name="a1512"></a><br />1512              <font color="blue">if</font> <strong>(</strong><strong>$index</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'['</font><strong>)</strong> <strong>{</strong><a name="a1513"></a><br />1513                  <strong>$index</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong> 1<strong>,</strong> -1<strong>)</strong>;<a name="a1514"></a><br />1514                  <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$index</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1515"></a><br />1515                      <strong>$output</strong> .= &quot;<font color="#66cccc"><strong>[</strong><strong>$index</strong><strong>]</strong></font>&quot;;<a name="a1516"></a><br />1516                  <strong>}</strong> elseif <strong>(</strong><strong>$index</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'$'</font><strong>)</strong> <strong>{</strong><a name="a1517"></a><br />1517                      <strong>$output</strong> .= <font color="#66cccc">&quot;[\$this-&gt;_tpl_vars['&quot;</font> . <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong> 1<strong>)</strong> . <font color="#66cccc">&quot;']]&quot;</font>;<a name="a1518"></a><br />1518                  <strong>}</strong> else <strong>{</strong><a name="a1519"></a><br />1519                      <strong>$parts</strong> = <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">'.'</font><strong>,</strong> <strong>$index</strong><strong>)</strong>;<a name="a1520"></a><br />1520                      <strong>$section</strong> = <strong>$parts</strong><strong>[</strong>0<strong>]</strong>;<a name="a1521"></a><br />1521                      <strong>$section_prop</strong> = isset<strong>(</strong><strong>$parts</strong><strong>[</strong>1<strong>]</strong><strong>)</strong> ? <strong>$parts</strong><strong>[</strong>1<strong>]</strong> : <font color="#66cccc">'index'</font>;<a name="a1522"></a><br />1522                      <strong>$output</strong> .= &quot;<font color="#66cccc"><strong>[</strong>\$this<strong>-&gt;</strong>_sections<strong>[</strong>'<strong>$section</strong>'<strong>]</strong><strong>[</strong>'<strong>$section_prop</strong>'<strong>]</strong><strong>]</strong></font>&quot;;<a name="a1523"></a><br />1523                  <strong>}</strong><a name="a1524"></a><br />1524              <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><strong>$index</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'.'</font><strong>)</strong> <strong>{</strong><a name="a1525"></a><br />1525                  <font color="blue">if</font> <strong>(</strong><strong>$index</strong><strong>{</strong>1<strong>}</strong> == <font color="#66cccc">'$'</font><strong>)</strong><a name="a1526"></a><br />1526                      <strong>$output</strong> .= <font color="#66cccc">&quot;[\$this-&gt;_tpl_vars['&quot;</font> . <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong> 2<strong>)</strong> . <font color="#66cccc">&quot;']]&quot;</font>;<a name="a1527"></a><br />1527                  else<a name="a1528"></a><br />1528                      <strong>$output</strong> .= <font color="#66cccc">&quot;['&quot;</font> . <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong> 1<strong>)</strong> . <font color="#66cccc">&quot;']&quot;</font>;<a name="a1529"></a><br />1529              <strong>}</strong> else <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong>0<strong>,</strong>2<strong>)</strong> == <font color="#66cccc">'-&gt;'</font><strong>)</strong> <strong>{</strong><a name="a1530"></a><br />1530                  <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong>2<strong>,</strong>2<strong>)</strong> == <font color="#66cccc">'__'</font><strong>)</strong> <strong>{</strong><a name="a1531"></a><br />1531                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">'call to internal object members is not allowed'</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1532"></a><br />1532                  <strong>}</strong> elseif<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$security">security</a> &amp;&amp; <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$index</strong><strong>,</strong>2<strong>,</strong>1<strong>)</strong> == <font color="#66cccc">'_'</font><strong>)</strong> <strong>{</strong><a name="a1533"></a><br />1533                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">'(secure) call to private object member is not allowed'</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1534"></a><br />1534                  <strong>}</strong><a name="a1535"></a><br />1535                  <strong>$output</strong> .= <strong>$index</strong>;<a name="a1536"></a><br />1536              <strong>}</strong> elseif <strong>(</strong><strong>$index</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'('</font><strong>)</strong> <strong>{</strong><a name="a1537"></a><br />1537                  <strong>$index</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_parenth_args">_parse_parenth_args</a><strong>(</strong><strong>$index</strong><strong>)</strong>;<a name="a1538"></a><br />1538                  <strong>$output</strong> .= <strong>$index</strong>;<a name="a1539"></a><br />1539              <strong>}</strong> else <strong>{</strong><a name="a1540"></a><br />1540                  <strong>$output</strong> .= <strong>$index</strong>;<a name="a1541"></a><br />1541              <strong>}</strong><a name="a1542"></a><br />1542          <strong>}</strong><a name="a1543"></a><br />1543          <a name="a1544"></a><br />1544          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$output</strong><strong>,</strong> <strong>$modifiers</strong><strong>)</strong>;<a name="a1545"></a><br />1545  <a name="a1546"></a><br />1546          <font color="blue">return</font> <strong>$output</strong>;<a name="a1547"></a><br />1547      <strong>}</strong><a name="a1548"></a><br />1548  <a name="a1549"></a><br />1549      <font color="#009999">/**</font><a name="a1550"></a><br />1550  <font color="#009999">	 * parse arguments in function call parenthesis</font><a name="a1551"></a><br />1551  <font color="#009999">	 *</font><a name="a1552"></a><br />1552  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$parenth_args </strong><a name="a1553"></a><br />1553  <font color="#009999">	 */</font><a name="a1554"></a><br />1554      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_parenth_args">_parse_parenth_args</a><strong>(</strong><strong>$parenth_args</strong><strong>)</strong><a name="a1555"></a><br />1555      <strong>{</strong><a name="a1556"></a><br />1556          <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'!'</font> . <strong>$this</strong><strong>-&gt;</strong><strong>_param_regexp</strong> . <font color="#66cccc">'!'</font><strong>,</strong><strong>$parenth_args</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1557"></a><br />1557          <strong>$match</strong> = <strong>$match</strong><strong>[</strong>0<strong>]</strong>;<a name="a1558"></a><br />1558          <a href="http://www.php.net/rsort">rsort</a><strong>(</strong><strong>$match</strong><strong>)</strong>;<a name="a1559"></a><br />1559          <a href="http://www.php.net/reset">reset</a><strong>(</strong><strong>$match</strong><strong>)</strong>;                        <a name="a1560"></a><br />1560          <strong>$orig_vals</strong> = <strong>$match</strong>;<a name="a1561"></a><br />1561          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_vars_props">_parse_vars_props</a><strong>(</strong><strong>$match</strong><strong>)</strong>;<a name="a1562"></a><br />1562          <font color="blue">return</font> <a href="http://www.php.net/str_replace">str_replace</a><strong>(</strong><strong>$orig_vals</strong><strong>,</strong> <strong>$match</strong><strong>,</strong> <strong>$parenth_args</strong><strong>)</strong>;<a name="a1563"></a><br />1563      <strong>}</strong>    <a name="a1564"></a><br />1564          <a name="a1565"></a><br />1565      <font color="#009999">/**</font><a name="a1566"></a><br />1566  <font color="#009999">	 * parse configuration variable expression into PHP code</font><a name="a1567"></a><br />1567  <font color="#009999">	 *</font><a name="a1568"></a><br />1568  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$conf_var_expr </strong><a name="a1569"></a><br />1569  <font color="#009999">	 */</font><a name="a1570"></a><br />1570      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_conf_var">_parse_conf_var</a><strong>(</strong><strong>$conf_var_expr</strong><strong>)</strong><a name="a1571"></a><br />1571      <strong>{</strong><a name="a1572"></a><br />1572          <strong>$parts</strong> = <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">'|'</font><strong>,</strong> <strong>$conf_var_expr</strong><strong>,</strong> 2<strong>)</strong>;<a name="a1573"></a><br />1573          <strong>$var_ref</strong> = <strong>$parts</strong><strong>[</strong>0<strong>]</strong>;<a name="a1574"></a><br />1574          <strong>$modifiers</strong> = isset<strong>(</strong><strong>$parts</strong><strong>[</strong>1<strong>]</strong><strong>)</strong> ? <strong>$parts</strong><strong>[</strong>1<strong>]</strong> : <font color="#66cccc">''</font>;<a name="a1575"></a><br />1575  <a name="a1576"></a><br />1576          <strong>$var_name</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$var_ref</strong><strong>,</strong> 1<strong>,</strong> -1<strong>)</strong>;<a name="a1577"></a><br />1577  <a name="a1578"></a><br />1578          <strong>$output</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_config<strong>[</strong>0<strong>]</strong><strong>[</strong>'vars'<strong>]</strong><strong>[</strong>'<strong>$var_name</strong>'<strong>]</strong></font>&quot;;<a name="a1579"></a><br />1579  <a name="a1580"></a><br />1580          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$output</strong><strong>,</strong> <strong>$modifiers</strong><strong>)</strong>;<a name="a1581"></a><br />1581  <a name="a1582"></a><br />1582          <font color="blue">return</font> <strong>$output</strong>;<a name="a1583"></a><br />1583      <strong>}</strong><a name="a1584"></a><br />1584  <a name="a1585"></a><br />1585  <a name="a1586"></a><br />1586      <font color="#009999">/**</font><a name="a1587"></a><br />1587  <font color="#009999">	 * parse section property expression into PHP code</font><a name="a1588"></a><br />1588  <font color="#009999">	 *</font><a name="a1589"></a><br />1589  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$section_prop_expr </strong><a name="a1590"></a><br />1590  <font color="#009999">	 */</font><a name="a1591"></a><br />1591      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_section_prop">_parse_section_prop</a><strong>(</strong><strong>$section_prop_expr</strong><strong>)</strong><a name="a1592"></a><br />1592      <strong>{</strong><a name="a1593"></a><br />1593          <strong>$parts</strong> = <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">'|'</font><strong>,</strong> <strong>$section_prop_expr</strong><strong>,</strong> 2<strong>)</strong>;<a name="a1594"></a><br />1594          <strong>$var_ref</strong> = <strong>$parts</strong><strong>[</strong>0<strong>]</strong>;<a name="a1595"></a><br />1595          <strong>$modifiers</strong> = isset<strong>(</strong><strong>$parts</strong><strong>[</strong>1<strong>]</strong><strong>)</strong> ? <strong>$parts</strong><strong>[</strong>1<strong>]</strong> : <font color="#66cccc">''</font>;<a name="a1596"></a><br />1596  <a name="a1597"></a><br />1597          <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'!%(\w+)\.(\w+)%!'</font><strong>,</strong> <strong>$var_ref</strong><strong>,</strong> <strong>$match</strong><strong>)</strong>;<a name="a1598"></a><br />1598          <strong>$section_name</strong> = <strong>$match</strong><strong>[</strong>1<strong>]</strong>;<a name="a1599"></a><br />1599          <strong>$prop_name</strong> = <strong>$match</strong><strong>[</strong>2<strong>]</strong>;<a name="a1600"></a><br />1600  <a name="a1601"></a><br />1601          <strong>$output</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_sections<strong>[</strong>'<strong>$section_name</strong>'<strong>]</strong><strong>[</strong>'<strong>$prop_name</strong>'<strong>]</strong></font>&quot;;<a name="a1602"></a><br />1602  <a name="a1603"></a><br />1603          <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>$output</strong><strong>,</strong> <strong>$modifiers</strong><strong>)</strong>;<a name="a1604"></a><br />1604  <a name="a1605"></a><br />1605          <font color="blue">return</font> <strong>$output</strong>;<a name="a1606"></a><br />1606      <strong>}</strong><a name="a1607"></a><br />1607  <a name="a1608"></a><br />1608  <a name="a1609"></a><br />1609      <font color="#009999">/**</font><a name="a1610"></a><br />1610  <font color="#009999">	 * parse modifier chain into PHP code</font><a name="a1611"></a><br />1611  <font color="#009999">	 *</font><a name="a1612"></a><br />1612  <font color="#009999">     * sets $output to parsed modified chain</font><a name="a1613"></a><br />1613  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$output </strong><a name="a1614"></a><br />1614  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$modifier_string </strong><a name="a1615"></a><br />1615  <font color="#009999">	 */</font><a name="a1616"></a><br />1616      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_parse_modifiers">_parse_modifiers</a><strong>(</strong><strong>&amp;</strong><strong>$output</strong><strong>,</strong> <strong>$modifier_string</strong><strong>)</strong><a name="a1617"></a><br />1617      <strong>{</strong><a name="a1618"></a><br />1618          <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'!\|(@?\w+)((?&gt;:(?:'</font>. <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> . <font color="#66cccc">'|[^|]+))*)!'</font><strong>,</strong> <font color="#66cccc">'|'</font> . <strong>$modifier_string</strong><strong>,</strong> <strong>$_match</strong><strong>)</strong>;<a name="a1619"></a><br />1619          list<strong>(</strong><strong>,</strong> <strong>$_modifiers</strong><strong>,</strong> <strong>$modifier_arg_strings</strong><strong>)</strong> = <strong>$_match</strong>;<a name="a1620"></a><br />1620  <a name="a1621"></a><br />1621          <font color="blue">for</font> <strong>(</strong><strong>$_i</strong> = 0<strong>,</strong> <strong>$_for_max</strong> = <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$_modifiers</strong><strong>)</strong>; <strong>$_i</strong> &lt; <strong>$_for_max</strong>; <strong>$_i</strong>++<strong>)</strong> <strong>{</strong><a name="a1622"></a><br />1622              <strong>$_modifier_name</strong> = <strong>$_modifiers</strong><strong>[</strong><strong>$_i</strong><strong>]</strong>;<a name="a1623"></a><br />1623              <a name="a1624"></a><br />1624              <font color="blue">if</font><strong>(</strong><strong>$_modifier_name</strong> == <font color="#66cccc">'smarty'</font><strong>)</strong> <strong>{</strong><a name="a1625"></a><br />1625                  <font color="green">// skip smarty modifier</font><a name="a1626"></a><br />1626                  continue;<a name="a1627"></a><br />1627              <strong>}</strong><a name="a1628"></a><br />1628              <a name="a1629"></a><br />1629              <a href="http://www.php.net/preg_match_all">preg_match_all</a><strong>(</strong><font color="#66cccc">'!:('</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_qstr_regexp">_qstr_regexp</a> . <font color="#66cccc">'|[^:]+)!'</font><strong>,</strong> <strong>$modifier_arg_strings</strong><strong>[</strong><strong>$_i</strong><strong>]</strong><strong>,</strong> <strong>$_match</strong><strong>)</strong>;<a name="a1630"></a><br />1630              <strong>$_modifier_args</strong> = <strong>$_match</strong><strong>[</strong>1<strong>]</strong>;<a name="a1631"></a><br />1631  <a name="a1632"></a><br />1632              <font color="blue">if</font> <strong>(</strong><strong>$_modifier_name</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'@'</font><strong>)</strong> <strong>{</strong><a name="a1633"></a><br />1633                  <strong>$_map_array</strong> = <font color="#66cccc">'false'</font>;<a name="a1634"></a><br />1634                  <strong>$_modifier_name</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$_modifier_name</strong><strong>,</strong> 1<strong>)</strong>;<a name="a1635"></a><br />1635              <strong>}</strong> else <strong>{</strong><a name="a1636"></a><br />1636                  <strong>$_map_array</strong> = <font color="#66cccc">'true'</font>;<a name="a1637"></a><br />1637              <strong>}</strong><a name="a1638"></a><br />1638              <a name="a1639"></a><br />1639              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_add_plugin">_add_plugin</a><strong>(</strong><font color="#66cccc">'modifier'</font><strong>,</strong> <strong>$_modifier_name</strong><strong>)</strong>;<a name="a1640"></a><br />1640              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_vars_props">_parse_vars_props</a><strong>(</strong><strong>$_modifier_args</strong><strong>)</strong>;<a name="a1641"></a><br />1641  <a name="a1642"></a><br />1642              <font color="blue">if</font><strong>(</strong><strong>$_modifier_name</strong> == <font color="#66cccc">'default'</font><strong>)</strong> <strong>{</strong><a name="a1643"></a><br />1643                  <font color="green">// supress notifications of default modifier vars and args</font><a name="a1644"></a><br />1644                  <font color="blue">if</font><strong>(</strong><strong>$output</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'$'</font><strong>)</strong> <strong>{</strong><a name="a1645"></a><br />1645                      <strong>$output</strong> = <font color="#66cccc">'@'</font> . <strong>$output</strong>;<a name="a1646"></a><br />1646                  <strong>}</strong><a name="a1647"></a><br />1647                  <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong>$_modifier_args</strong><strong>[</strong>0<strong>]</strong><strong>)</strong> &amp;&amp; <strong>$_modifier_args</strong><strong>[</strong>0<strong>]</strong><strong>{</strong>0<strong>}</strong> == <font color="#66cccc">'$'</font><strong>)</strong> <strong>{</strong><a name="a1648"></a><br />1648                      <strong>$_modifier_args</strong><strong>[</strong>0<strong>]</strong> = <font color="#66cccc">'@'</font> . <strong>$_modifier_args</strong><strong>[</strong>0<strong>]</strong>;<a name="a1649"></a><br />1649                  <strong>}</strong><a name="a1650"></a><br />1650              <strong>}</strong><a name="a1651"></a><br />1651              <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$_modifier_args</strong><strong>)</strong> &gt; 0<strong>)</strong><a name="a1652"></a><br />1652                  <strong>$_modifier_args</strong> = <font color="#66cccc">', '</font>.<a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">', '</font><strong>,</strong> <strong>$_modifier_args</strong><strong>)</strong>;<a name="a1653"></a><br />1653              else<a name="a1654"></a><br />1654                  <strong>$_modifier_args</strong> = <font color="#66cccc">''</font>;<a name="a1655"></a><br />1655  <a name="a1656"></a><br />1656              <strong>$output</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_run_mod_handler('<strong>$_modifier_name</strong>', <strong>$_map_array</strong>, <strong>$output</strong><strong>$_modifier_args</strong>)</font>&quot;;<a name="a1657"></a><br />1657          <strong>}</strong><a name="a1658"></a><br />1658      <strong>}</strong><a name="a1659"></a><br />1659  <a name="a1660"></a><br />1660  <a name="a1661"></a><br />1661      <font color="#009999">/**</font><a name="a1662"></a><br />1662  <font color="#009999">	 * add plugin</font><a name="a1663"></a><br />1663  <font color="#009999">	 *</font><a name="a1664"></a><br />1664  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$type </strong><a name="a1665"></a><br />1665  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$name </strong><a name="a1666"></a><br />1666  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>boolean? </em><font color="#009999"></font><strong>$delayed_loading </strong><a name="a1667"></a><br />1667  <font color="#009999">	 */</font><a name="a1668"></a><br />1668      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_add_plugin">_add_plugin</a><strong>(</strong><strong>$type</strong><strong>,</strong> <strong>$name</strong><strong>,</strong> <strong>$delayed_loading</strong> = null<strong>)</strong><a name="a1669"></a><br />1669      <strong>{</strong><a name="a1670"></a><br />1670          <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a><strong>[</strong><strong>$type</strong><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1671"></a><br />1671              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a><strong>[</strong><strong>$type</strong><strong>]</strong> = array<strong>(</strong><strong>)</strong>;<a name="a1672"></a><br />1672          <strong>}</strong><a name="a1673"></a><br />1673          <font color="blue">if</font> <strong>(</strong><strong>!</strong>isset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a><strong>[</strong><strong>$type</strong><strong>]</strong><strong>[</strong><strong>$name</strong><strong>]</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1674"></a><br />1674              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_plugin_info">_plugin_info</a><strong>[</strong><strong>$type</strong><strong>]</strong><strong>[</strong><strong>$name</strong><strong>]</strong> = array<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_file">_current_file</a><strong>,</strong><a name="a1675"></a><br />1675                                                        <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a><strong>,</strong><a name="a1676"></a><br />1676                                                        <strong>$delayed_loading</strong><strong>)</strong>;<a name="a1677"></a><br />1677          <strong>}</strong><a name="a1678"></a><br />1678      <strong>}</strong><a name="a1679"></a><br />1679      <a name="a1680"></a><br />1680  <a name="a1681"></a><br />1681      <font color="#009999">/**</font><a name="a1682"></a><br />1682  <font color="#009999">	 * Compiles references of type $smarty.foo</font><a name="a1683"></a><br />1683  <font color="#009999">	 *</font><a name="a1684"></a><br />1684  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$indexes </strong><a name="a1685"></a><br />1685  <font color="#009999">	 */</font><a name="a1686"></a><br />1686      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_compile_smarty_ref">_compile_smarty_ref</a><strong>(</strong><strong>&amp;</strong><strong>$indexes</strong><strong>)</strong><a name="a1687"></a><br />1687      <strong>{</strong><a name="a1688"></a><br />1688          <font color="green">/* Extract the reference name. */</font><a name="a1689"></a><br />1689          <strong>$_ref</strong> = <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$indexes</strong><strong>[</strong>0<strong>]</strong><strong>,</strong> 1<strong>)</strong>;<a name="a1690"></a><br />1690  <a name="a1691"></a><br />1691          <font color="blue">foreach</font><strong>(</strong><strong>$indexes</strong> as <strong>$_index</strong><strong>)</strong> <strong>{</strong>        <a name="a1692"></a><br />1692              <font color="blue">if</font> <strong>(</strong><strong>$_index</strong><strong>{</strong>0<strong>}</strong> != <font color="#66cccc">'.'</font><strong>)</strong> <strong>{</strong><a name="a1693"></a><br />1693                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">'$smarty'</font> . <a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">''</font><strong>,</strong> <a href="http://www.php.net/array_slice">array_slice</a><strong>(</strong><strong>$indexes</strong><strong>,</strong> 0<strong>,</strong> 2<strong>)</strong><strong>)</strong> . <font color="#66cccc">' is an invalid reference'</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1694"></a><br />1694              <strong>}</strong><a name="a1695"></a><br />1695          <strong>}</strong><a name="a1696"></a><br />1696          <a name="a1697"></a><br />1697          <font color="blue">switch</font> <strong>(</strong><strong>$_ref</strong><strong>)</strong> <strong>{</strong><a name="a1698"></a><br />1698              case <font color="#66cccc">'now'</font>:<a name="a1699"></a><br />1699                  <strong>$compiled_ref</strong> = <font color="#66cccc">'time()'</font>;<a name="a1700"></a><br />1700                  <strong>$_max_index</strong> = 1;<a name="a1701"></a><br />1701                  break;<a name="a1702"></a><br />1702  <a name="a1703"></a><br />1703              case <font color="#66cccc">'foreach'</font>:<a name="a1704"></a><br />1704              case <font color="#66cccc">'section'</font>:<a name="a1705"></a><br />1705                  <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$indexes</strong><strong>)</strong>;<a name="a1706"></a><br />1706                  <strong>$_var</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$indexes</strong><strong>[</strong>0<strong>]</strong><strong>,</strong> 1<strong>)</strong><strong>)</strong>;<a name="a1707"></a><br />1707                  <font color="blue">if</font> <strong>(</strong><strong>$_ref</strong> == <font color="#66cccc">'foreach'</font><strong>)</strong><a name="a1708"></a><br />1708                      <strong>$compiled_ref</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_foreach<strong>[</strong><strong>$_var</strong><strong>]</strong></font>&quot;;<a name="a1709"></a><br />1709                  else<a name="a1710"></a><br />1710                      <strong>$compiled_ref</strong> = &quot;<font color="#66cccc">\$this<strong>-&gt;</strong>_sections<strong>[</strong><strong>$_var</strong><strong>]</strong></font>&quot;;<a name="a1711"></a><br />1711                  break;<a name="a1712"></a><br />1712  <a name="a1713"></a><br />1713              case <font color="#66cccc">'get'</font>:<a name="a1714"></a><br />1714                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_GET_VARS']&quot;</font>;<a name="a1715"></a><br />1715                  break;<a name="a1716"></a><br />1716  <a name="a1717"></a><br />1717              case <font color="#66cccc">'post'</font>:<a name="a1718"></a><br />1718                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_POST_VARS']&quot;</font>;<a name="a1719"></a><br />1719                  break;<a name="a1720"></a><br />1720  <a name="a1721"></a><br />1721              case <font color="#66cccc">'cookies'</font>:<a name="a1722"></a><br />1722                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_COOKIE_VARS']&quot;</font>;<a name="a1723"></a><br />1723                  break;<a name="a1724"></a><br />1724  <a name="a1725"></a><br />1725              case <font color="#66cccc">'env'</font>:<a name="a1726"></a><br />1726                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_ENV_VARS']&quot;</font>;<a name="a1727"></a><br />1727                  break;<a name="a1728"></a><br />1728  <a name="a1729"></a><br />1729              case <font color="#66cccc">'server'</font>:<a name="a1730"></a><br />1730                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_SERVER_VARS']&quot;</font>;<a name="a1731"></a><br />1731                  break;<a name="a1732"></a><br />1732  <a name="a1733"></a><br />1733              case <font color="#66cccc">'session'</font>:<a name="a1734"></a><br />1734                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$GLOBALS['HTTP_SESSION_VARS']&quot;</font>;<a name="a1735"></a><br />1735                  break;<a name="a1736"></a><br />1736  <a name="a1737"></a><br />1737              <font color="green">/*</font><a name="a1738"></a><br />1738  <font color="green">             * These cases are handled either at run-time or elsewhere in the</font><a name="a1739"></a><br />1739  <font color="green">             * compiler.</font><a name="a1740"></a><br />1740  <font color="green">             */</font><a name="a1741"></a><br />1741              case <font color="#66cccc">'request'</font>:<a name="a1742"></a><br />1742                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_init_smarty_vars">_init_smarty_vars</a> = true;<a name="a1743"></a><br />1743                  <font color="blue">return</font> null;<a name="a1744"></a><br />1744  <a name="a1745"></a><br />1745              case <font color="#66cccc">'capture'</font>:<a name="a1746"></a><br />1746                  <font color="blue">return</font> null;<a name="a1747"></a><br />1747  <a name="a1748"></a><br />1748              case <font color="#66cccc">'template'</font>:<a name="a1749"></a><br />1749                  <strong>$compiled_ref</strong> = &quot;<font color="#66cccc">'<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_file">_current_file</a>'</font>&quot;;<a name="a1750"></a><br />1750                  <strong>$_max_index</strong> = 1;<a name="a1751"></a><br />1751                  break;<a name="a1752"></a><br />1752                  <a name="a1753"></a><br />1753              case <font color="#66cccc">'version'</font>:<a name="a1754"></a><br />1754                  <strong>$compiled_ref</strong> = &quot;<font color="#66cccc">'<strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_version">_version</a>'</font>&quot;;<a name="a1755"></a><br />1755                  <strong>$_max_index</strong> = 1;<a name="a1756"></a><br />1756                  break;<a name="a1757"></a><br />1757  <a name="a1758"></a><br />1758              case <font color="#66cccc">'const'</font>:<a name="a1759"></a><br />1759                  <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$indexes</strong><strong>)</strong>;<a name="a1760"></a><br />1760                  <strong>$_val</strong> = <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_parse_var_props">_parse_var_props</a><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$indexes</strong><strong>[</strong>0<strong>]</strong><strong>,</strong>1<strong>)</strong><strong>)</strong>;<a name="a1761"></a><br />1761                  <strong>$compiled_ref</strong> = <font color="#66cccc">'@constant('</font> . <strong>$_val</strong> . <font color="#66cccc">')'</font>;<a name="a1762"></a><br />1762                  <strong>$_max_index</strong> = 1;<a name="a1763"></a><br />1763                  break;<a name="a1764"></a><br />1764  <a name="a1765"></a><br />1765              case <font color="#66cccc">'config'</font>:<a name="a1766"></a><br />1766                  <strong>$compiled_ref</strong> = <font color="#66cccc">&quot;\$this-&gt;_config[0]['vars']&quot;</font>;<a name="a1767"></a><br />1767                  <strong>$_max_index</strong> = 2;<a name="a1768"></a><br />1768                  break;<a name="a1769"></a><br />1769  <a name="a1770"></a><br />1770              default:<a name="a1771"></a><br />1771                  <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">'$smarty.'</font> . <strong>$_ref</strong> . <font color="#66cccc">' is an unknown reference'</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1772"></a><br />1772                  break;<a name="a1773"></a><br />1773          <strong>}</strong><a name="a1774"></a><br />1774  <a name="a1775"></a><br />1775          <font color="blue">if</font> <strong>(</strong>isset<strong>(</strong><strong>$_max_index</strong><strong>)</strong> &amp;&amp; <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$indexes</strong><strong>)</strong> &gt; <strong>$_max_index</strong><strong>)</strong> <strong>{</strong><a name="a1776"></a><br />1776              <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><font color="#66cccc">'$smarty'</font> . <a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">''</font><strong>,</strong> <strong>$indexes</strong><strong>)</strong> .<font color="#66cccc">' is an invalid reference'</font><strong>,</strong> E_USER_ERROR<strong>,</strong> __FILE__<strong>,</strong> __LINE__<strong>)</strong>;<a name="a1777"></a><br />1777          <strong>}</strong><a name="a1778"></a><br />1778  <a name="a1779"></a><br />1779          <a href="http://www.php.net/array_shift">array_shift</a><strong>(</strong><strong>$indexes</strong><strong>)</strong>;<a name="a1780"></a><br />1780          <font color="blue">return</font> <strong>$compiled_ref</strong>;<a name="a1781"></a><br />1781      <strong>}</strong><a name="a1782"></a><br />1782  <a name="a1783"></a><br />1783  <a name="a1784"></a><br />1784      <font color="#009999">/**</font><a name="a1785"></a><br />1785  <font color="#009999">	 * load pre- and post-filters</font><a name="a1786"></a><br />1786  <font color="#009999">	 */</font><a name="a1787"></a><br />1787      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_load_filters">_load_filters</a><strong>(</strong><strong>)</strong><a name="a1788"></a><br />1788      <strong>{</strong><a name="a1789"></a><br />1789          <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong><strong>)</strong> &gt; 0<strong>)</strong> <strong>{</strong><a name="a1790"></a><br />1790              <font color="blue">foreach</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong> as <strong>$filter_name</strong> =&gt; <strong>$prefilter</strong><strong>)</strong> <strong>{</strong><a name="a1791"></a><br />1791                  <font color="blue">if</font> <strong>(</strong><strong>$prefilter</strong> === false<strong>)</strong> <strong>{</strong><a name="a1792"></a><br />1792                      unset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'prefilter'</font><strong>]</strong><strong>[</strong><strong>$filter_name</strong><strong>]</strong><strong>)</strong>;<a name="a1793"></a><br />1793                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_load_plugins">_load_plugins</a><strong>(</strong>array<strong>(</strong>array<strong>(</strong><font color="#66cccc">'prefilter'</font><strong>,</strong> <strong>$filter_name</strong><strong>,</strong> null<strong>,</strong> null<strong>,</strong> false<strong>)</strong><strong>)</strong><strong>)</strong>;<a name="a1794"></a><br />1794                  <strong>}</strong><a name="a1795"></a><br />1795              <strong>}</strong><a name="a1796"></a><br />1796          <strong>}</strong><a name="a1797"></a><br />1797          <font color="blue">if</font> <strong>(</strong><a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong><strong>)</strong> &gt; 0<strong>)</strong> <strong>{</strong><a name="a1798"></a><br />1798              <font color="blue">foreach</font> <strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong> as <strong>$filter_name</strong> =&gt; <strong>$postfilter</strong><strong>)</strong> <strong>{</strong><a name="a1799"></a><br />1799                  <font color="blue">if</font> <strong>(</strong><strong>$postfilter</strong> === false<strong>)</strong> <strong>{</strong><a name="a1800"></a><br />1800                      unset<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#var$_plugins">_plugins</a><strong>[</strong><font color="#66cccc">'postfilter'</font><strong>]</strong><strong>[</strong><strong>$filter_name</strong><strong>]</strong><strong>)</strong>;<a name="a1801"></a><br />1801                      <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty.html#method_load_plugins">_load_plugins</a><strong>(</strong>array<strong>(</strong>array<strong>(</strong><font color="#66cccc">'postfilter'</font><strong>,</strong> <strong>$filter_name</strong><strong>,</strong> null<strong>,</strong> null<strong>,</strong> false<strong>)</strong><strong>)</strong><strong>)</strong>;<a name="a1802"></a><br />1802                  <strong>}</strong><a name="a1803"></a><br />1803              <strong>}</strong><a name="a1804"></a><br />1804          <strong>}</strong><a name="a1805"></a><br />1805      <strong>}</strong><a name="a1806"></a><br />1806  <a name="a1807"></a><br />1807  <a name="a1808"></a><br />1808      <font color="#009999">/**</font><a name="a1809"></a><br />1809  <font color="#009999">	 * display Smarty syntax error</font><a name="a1810"></a><br />1810  <font color="#009999">	 *</font><a name="a1811"></a><br />1811  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$error_msg </strong><a name="a1812"></a><br />1812  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>integer </em><font color="#009999"></font><strong>$error_type </strong><a name="a1813"></a><br />1813  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$file </strong><a name="a1814"></a><br />1814  <font color="#009999">	 *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>integer </em><font color="#009999"></font><strong>$line </strong><a name="a1815"></a><br />1815  <font color="#009999">	 */</font><a name="a1816"></a><br />1816      <font color="blue">function</font> <a href="../Smarty/Smarty_Compiler.html#method_syntax_error">_syntax_error</a><strong>(</strong><strong>$error_msg</strong><strong>,</strong> <strong>$error_type</strong> = E_USER_ERROR<strong>,</strong> <strong>$file</strong>=null<strong>,</strong> <strong>$line</strong>=null<strong>)</strong><a name="a1817"></a><br />1817      <strong>{</strong><a name="a1818"></a><br />1818          <font color="blue">if</font><strong>(</strong>isset<strong>(</strong><strong>$file</strong><strong>)</strong> &amp;&amp; isset<strong>(</strong><strong>$line</strong><strong>)</strong><strong>)</strong> <strong>{</strong><a name="a1819"></a><br />1819              <strong>$info</strong> = <font color="#66cccc">' ('</font>.<a href="http://www.php.net/basename">basename</a><strong>(</strong><strong>$file</strong><strong>)</strong>.&quot;<font color="#66cccc">, line <strong>$line</strong>)</font>&quot;;<a name="a1820"></a><br />1820          <strong>}</strong> else <strong>{</strong><a name="a1821"></a><br />1821              <strong>$info</strong> = null;<a name="a1822"></a><br />1822          <strong>}</strong><a name="a1823"></a><br />1823          <a href="../Smarty/Smarty.html#methodtrigger_error">trigger_error</a><strong>(</strong><font color="#66cccc">'Smarty: [in '</font> . <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_file">_current_file</a> . <font color="#66cccc">' line '</font> .<a name="a1824"></a><br />1824                        <strong>$this</strong><strong>-&gt;</strong><a href="../Smarty/Smarty_Compiler.html#var$_current_line_no">_current_line_no</a> . &quot;<font color="#66cccc"><strong>]</strong>: syntax error: <strong>$error_msg</strong><strong>$info</strong></font>&quot;<strong>,</strong> <strong>$error_type</strong><strong>)</strong>;<a name="a1825"></a><br />1825      <strong>}</strong><a name="a1826"></a><br />1826  <strong>}</strong><a name="a1827"></a><br />1827  <a name="a1828"></a><br />1828  <font color="#009999">/**</font><a name="a1829"></a><br />1829  <font color="#009999"> * compare to values by their string length</font><a name="a1830"></a><br />1830  <font color="#009999"> *</font><a name="a1831"></a><br />1831  <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a1832"></a><br />1832  <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$a </strong><a name="a1833"></a><br />1833  <font color="#009999"> *</font><font color="#009999"> </font><strong><font color = "#0099FF">@param </font></strong><font color="#009999"></font><em>string </em><font color="#009999"></font><strong>$b </strong><a name="a1834"></a><br />1834  <font color="#009999"> */</font><a name="a1835"></a><br />1835  <font color="blue">function</font> <a href="../Smarty/_universibo2_framework_smarty_Smarty_Compiler_class_php.html#function_smarty_sort_length">_smarty_sort_length</a><strong>(</strong><strong>$a</strong><strong>,</strong> <strong>$b</strong><strong>)</strong><a name="a1836"></a><br />1836  <strong>{</strong><a name="a1837"></a><br />1837      <font color="blue">if</font><strong>(</strong><strong>$a</strong> == <strong>$b</strong><strong>)</strong><a name="a1838"></a><br />1838          <font color="blue">return</font> 0;<a name="a1839"></a><br />1839  <a name="a1840"></a><br />1840      <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$a</strong><strong>)</strong> == <a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$b</strong><strong>)</strong><strong>)</strong><a name="a1841"></a><br />1841          <font color="blue">return</font> <strong>(</strong><strong>$a</strong> &gt; <strong>$b</strong><strong>)</strong> ? -1 : 1;<a name="a1842"></a><br />1842  <a name="a1843"></a><br />1843      <font color="blue">return</font> <strong>(</strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$a</strong><strong>)</strong> &gt; <a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$b</strong><strong>)</strong><strong>)</strong> ? -1 : 1;<a name="a1844"></a><br />1844  <strong>}</strong><a name="a1845"></a><br />1845  <a name="a1846"></a><br />1846  <a name="a1847"></a><br />1847  <font color="green">/* vim: set et: */</font><a name="a1848"></a><br />1848  <a name="a1849"></a><br />1849  <strong>?&gt;</strong></pre>
        <div class="credit">
		    <hr />
		    Documentation generated on Fri, 28 Nov 2003 13:11:47 +0100 by <a href="http://www.phpdoc.org">phpDocumentor 1.2.3</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>